import{a as no,b as re,c as I,d as fe,e as Lt,f as z,g as ht,h as d}from"./chunk-BJPCCRRA.js";var Le=I((Uf,fr)=>{"use strict";d();var Ke=typeof Reflect=="object"?Reflect:null,Wn=Ke&&typeof Ke.apply=="function"?Ke.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},Mt;Ke&&typeof Ke.ownKeys=="function"?Mt=Ke.ownKeys:Object.getOwnPropertySymbols?Mt=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Mt=function(e){return Object.getOwnPropertyNames(e)};function io(r){console&&console.warn&&console.warn(r)}var Gn=Number.isNaN||function(e){return e!==e};function M(){M.init.call(this)}fr.exports=M;fr.exports.once=lo;M.EventEmitter=M;M.prototype._events=void 0;M.prototype._eventsCount=0;M.prototype._maxListeners=void 0;var Hn=10;function Ft(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(M,"defaultMaxListeners",{enumerable:!0,get:function(){return Hn},set:function(r){if(typeof r!="number"||r<0||Gn(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Hn=r}});M.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};M.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Gn(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function zn(r){return r._maxListeners===void 0?M.defaultMaxListeners:r._maxListeners}M.prototype.getMaxListeners=function(){return zn(this)};M.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var l=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw l.context=a,l}var o=s[e];if(o===void 0)return!1;if(typeof o=="function")Wn(o,this,t);else for(var f=o.length,h=Zn(o,f),n=0;n<f;++n)Wn(h[n],this,t);return!0};function Kn(r,e,t,n){var i,s,a;if(Ft(t),s=r._events,s===void 0?(s=r._events=Object.create(null),r._eventsCount=0):(s.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),s=r._events),a=s[e]),a===void 0)a=s[e]=t,++r._eventsCount;else if(typeof a=="function"?a=s[e]=n?[t,a]:[a,t]:n?a.unshift(t):a.push(t),i=zn(r),i>0&&a.length>i&&!a.warned){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=r,l.type=e,l.count=a.length,io(l)}return r}M.prototype.addListener=function(e,t){return Kn(this,e,t,!1)};M.prototype.on=M.prototype.addListener;M.prototype.prependListener=function(e,t){return Kn(this,e,t,!0)};function so(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Yn(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=so.bind(n);return i.listener=t,n.wrapFn=i,i}M.prototype.once=function(e,t){return Ft(t),this.on(e,Yn(this,e,t)),this};M.prototype.prependOnceListener=function(e,t){return Ft(t),this.prependListener(e,Yn(this,e,t)),this};M.prototype.removeListener=function(e,t){var n,i,s,a,l;if(Ft(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(s=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){l=n[a].listener,s=a;break}if(s<0)return this;s===0?n.shift():ao(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,l||t)}return this};M.prototype.off=M.prototype.removeListener;M.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),a;for(i=0;i<s.length;++i)a=s[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function Jn(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?oo(i):Zn(i,i.length)}M.prototype.listeners=function(e){return Jn(this,e,!0)};M.prototype.rawListeners=function(e){return Jn(this,e,!1)};M.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):Xn.call(r,e)};M.prototype.listenerCount=Xn;function Xn(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}M.prototype.eventNames=function(){return this._eventsCount>0?Mt(this._events):[]};function Zn(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function ao(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function oo(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function lo(r,e){return new Promise(function(t,n){function i(a){r.removeListener(e,s),n(a)}function s(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}ei(r,e,s,{once:!0}),e!=="error"&&uo(r,i,{once:!0})})}function uo(r,e,t){typeof r.on=="function"&&ei(r,"error",e,t)}function ei(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(s){n.once&&r.removeEventListener(e,i),t(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var pt={};fe(pt,{default:()=>co});var co,mt=re(()=>{d();co={}});function yt(r){let e=1779033703,t=3144134277,n=1013904242,i=2773480762,s=1359893119,a=2600822924,l=528734635,o=1541459225,f=0,h=0,y=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],E=(N,S)=>N>>>S|N<<32-S,D=new Uint32Array(64),k=new Uint8Array(64),K=()=>{for(let B=0,X=0;B<16;B++,X+=4)D[B]=k[X]<<24|k[X+1]<<16|k[X+2]<<8|k[X+3];for(let B=16;B<64;B++){let X=E(D[B-15],7)^E(D[B-15],18)^D[B-15]>>>3,U=E(D[B-2],17)^E(D[B-2],19)^D[B-2]>>>10;D[B]=D[B-16]+X+D[B-7]+U|0}let N=e,S=t,Ee=n,ue=i,H=s,me=a,we=l,Se=o;for(let B=0;B<64;B++){let X=E(H,6)^E(H,11)^E(H,25),U=H&me^~H&we,ce=Se+X+U+y[B]+D[B]|0,je=E(N,2)^E(N,13)^E(N,22),Pe=N&S^N&Ee^S&Ee,q=je+Pe|0;Se=we,we=me,me=H,H=ue+ce|0,ue=Ee,Ee=S,S=N,N=ce+q|0}e=e+N|0,t=t+S|0,n=n+Ee|0,i=i+ue|0,s=s+H|0,a=a+me|0,l=l+we|0,o=o+Se|0,h=0},_e=N=>{typeof N=="string"&&(N=new TextEncoder().encode(N));for(let S=0;S<N.length;S++)k[h++]=N[S],h===64&&K();f+=N.length},Ae=()=>{if(k[h++]=128,h==64&&K(),h+8>64){for(;h<64;)k[h++]=0;K()}for(;h<58;)k[h++]=0;let N=f*8;k[h++]=N/1099511627776&255,k[h++]=N/4294967296&255,k[h++]=N>>>24,k[h++]=N>>>16&255,k[h++]=N>>>8&255,k[h++]=N&255,K();let S=new Uint8Array(32);return S[0]=e>>>24,S[1]=e>>>16&255,S[2]=e>>>8&255,S[3]=e&255,S[4]=t>>>24,S[5]=t>>>16&255,S[6]=t>>>8&255,S[7]=t&255,S[8]=n>>>24,S[9]=n>>>16&255,S[10]=n>>>8&255,S[11]=n&255,S[12]=i>>>24,S[13]=i>>>16&255,S[14]=i>>>8&255,S[15]=i&255,S[16]=s>>>24,S[17]=s>>>16&255,S[18]=s>>>8&255,S[19]=s&255,S[20]=a>>>24,S[21]=a>>>16&255,S[22]=a>>>8&255,S[23]=a&255,S[24]=l>>>24,S[25]=l>>>16&255,S[26]=l>>>8&255,S[27]=l&255,S[28]=o>>>24,S[29]=o>>>16&255,S[30]=o>>>8&255,S[31]=o&255,S};return r===void 0?{add:_e,digest:Ae}:(_e(r),Ae())}var ti=re(()=>{"use strict";d()});var dr={};fe(dr,{createHash:()=>ho,createHmac:()=>po,randomBytes:()=>fo});function fo(r){return crypto.getRandomValues(Buffer.alloc(r))}function ho(r){if(r!=="sha256")throw new Error("Only sha256 is supported");return{update:function(e){return{digest:function(){return Buffer.from(yt(e))}}}}}function po(r,e){if(r!=="sha256")throw new Error("Only sha256 is supported");return{update:function(t){return{digest:function(){typeof e=="string"&&(e=new TextEncoder().encode(e)),typeof t=="string"&&(t=new TextEncoder().encode(t));let n=e.length;if(n>64)e=yt(e);else if(n<64){let o=new Uint8Array(64);o.set(e),e=o}let i=new Uint8Array(64),s=new Uint8Array(64);for(let o=0;o<64;o++)i[o]=54^e[o],s[o]=92^e[o];let a=new Uint8Array(t.length+64);a.set(i,0),a.set(t,64);let l=new Uint8Array(64+32);return l.set(s,0),l.set(yt(a),64),Buffer.from(yt(l))}}}}}var hr=re(()=>{d();ti()});var pr=I(ri=>{"use strict";d();ri.parse=function(r,e){return new vt(r,e).parse()};var vt=class{constructor(e,t){this.source=e,this.transform=t||mo,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var e=this.source[this.position++];return e==="\\"?{value:this.source[this.position++],escaped:!0}:{value:e,escaped:!1}}record(e){this.recorded.push(e)}newEntry(e){var t;(this.recorded.length>0||e)&&(t=this.recorded.join(""),t==="NULL"&&!e&&(t=null),t!==null&&(t=this.transform(t)),this.entries.push(t),this.recorded=[])}consumeDimensions(){if(this.source[0]==="[")for(;!this.isEof();){var e=this.nextCharacter();if(e.value==="=")break}}parse(e){var t,n,i;for(this.consumeDimensions();!this.isEof();)if(t=this.nextCharacter(),t.value==="{"&&!i)this.dimension++,this.dimension>1&&(n=new vt(this.source.substr(this.position-1),this.transform),this.entries.push(n.parse(!0)),this.position+=n.position-2);else if(t.value==="}"&&!i){if(this.dimension--,!this.dimension&&(this.newEntry(),e))return this.entries}else t.value==='"'&&!t.escaped?(i&&this.newEntry(!0),i=!i):t.value===","&&!i?this.newEntry():this.record(t.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}};function mo(r){return r}});var mr=I((jf,ni)=>{d();var yo=pr();ni.exports={create:function(r,e){return{parse:function(){return yo.parse(r,e)}}}}});var ai=I((Wf,si)=>{"use strict";d();var vo=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,go=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,_o=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,Eo=/^-?infinity$/;si.exports=function(e){if(Eo.test(e))return Number(e.replace("i","I"));var t=vo.exec(e);if(!t)return wo(e)||null;var n=!!t[8],i=parseInt(t[1],10);n&&(i=ii(i));var s=parseInt(t[2],10)-1,a=t[3],l=parseInt(t[4],10),o=parseInt(t[5],10),f=parseInt(t[6],10),h=t[7];h=h?1e3*parseFloat(h):0;var y,E=So(e);return E!=null?(y=new Date(Date.UTC(i,s,a,l,o,f,h)),yr(i)&&y.setUTCFullYear(i),E!==0&&y.setTime(y.getTime()-E)):(y=new Date(i,s,a,l,o,f,h),yr(i)&&y.setFullYear(i)),y};function wo(r){var e=go.exec(r);if(!!e){var t=parseInt(e[1],10),n=!!e[4];n&&(t=ii(t));var i=parseInt(e[2],10)-1,s=e[3],a=new Date(t,i,s);return yr(t)&&a.setFullYear(t),a}}function So(r){if(r.endsWith("+00"))return 0;var e=_o.exec(r.split(" ")[1]);if(!!e){var t=e[1];if(t==="Z")return 0;var n=t==="-"?-1:1,i=parseInt(e[2],10)*3600+parseInt(e[3]||0,10)*60+parseInt(e[4]||0,10);return i*n*1e3}}function ii(r){return-(r-1)}function yr(r){return r>=0&&r<100}});var li=I((Hf,oi)=>{d();oi.exports=xo;var bo=Object.prototype.hasOwnProperty;function xo(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)bo.call(t,n)&&(r[n]=t[n])}return r}});var fi=I((Gf,ci)=>{"use strict";d();var Ao=li();ci.exports=Ye;function Ye(r){if(!(this instanceof Ye))return new Ye(r);Ao(this,Fo(r))}var Ro=["seconds","minutes","hours","days","months","years"];Ye.prototype.toPostgres=function(){var r=Ro.filter(this.hasOwnProperty,this);return this.milliseconds&&r.indexOf("seconds")<0&&r.push("seconds"),r.length===0?"0":r.map(function(e){var t=this[e]||0;return e==="seconds"&&this.milliseconds&&(t=(t+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),t+" "+e},this).join(" ")};var Io={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},To=["years","months","days"],Co=["hours","minutes","seconds"];Ye.prototype.toISOString=Ye.prototype.toISO=function(){var r=To.map(t,this).join(""),e=Co.map(t,this).join("");return"P"+r+"T"+e;function t(n){var i=this[n]||0;return n==="seconds"&&this.milliseconds&&(i=(i+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),i+Io[n]}};var vr="([+-]?\\d+)",Po=vr+"\\s+years?",Do=vr+"\\s+mons?",Oo=vr+"\\s+days?",No="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",qo=new RegExp([Po,Do,Oo,No].map(function(r){return"("+r+")?"}).join("\\s*")),ui={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},Lo=["hours","minutes","seconds","milliseconds"];function Mo(r){var e=r+"000000".slice(r.length);return parseInt(e,10)/1e3}function Fo(r){if(!r)return{};var e=qo.exec(r),t=e[8]==="-";return Object.keys(ui).reduce(function(n,i){var s=ui[i],a=e[s];return!a||(a=i==="milliseconds"?Mo(a):parseInt(a,10),!a)||(t&&~Lo.indexOf(i)&&(a*=-1),n[i]=a),n},{})}});var hi=I((zf,di)=>{"use strict";d();di.exports=function(e){if(/^\\x/.test(e))return new Buffer(e.substr(2),"hex");for(var t="",n=0;n<e.length;)if(e[n]!=="\\")t+=e[n],++n;else if(/[0-7]{3}/.test(e.substr(n+1,3)))t+=String.fromCharCode(parseInt(e.substr(n+1,3),8)),n+=4;else{for(var i=1;n+i<e.length&&e[n+i]==="\\";)i++;for(var s=0;s<Math.floor(i/2);++s)t+="\\";n+=Math.floor(i/2)*2}return new Buffer(t,"binary")}});var Ei=I((Kf,_i)=>{d();var gt=pr(),_t=mr(),kt=ai(),mi=fi(),yi=hi();function Bt(r){return function(t){return t===null?t:r(t)}}function vi(r){return r===null?r:r==="TRUE"||r==="t"||r==="true"||r==="y"||r==="yes"||r==="on"||r==="1"}function ko(r){return r?gt.parse(r,vi):null}function Bo(r){return parseInt(r,10)}function gr(r){return r?gt.parse(r,Bt(Bo)):null}function Uo(r){return r?gt.parse(r,Bt(function(e){return gi(e).trim()})):null}var Qo=function(r){if(!r)return null;var e=_t.create(r,function(t){return t!==null&&(t=Sr(t)),t});return e.parse()},_r=function(r){if(!r)return null;var e=_t.create(r,function(t){return t!==null&&(t=parseFloat(t)),t});return e.parse()},de=function(r){if(!r)return null;var e=_t.create(r);return e.parse()},Er=function(r){if(!r)return null;var e=_t.create(r,function(t){return t!==null&&(t=kt(t)),t});return e.parse()},$o=function(r){if(!r)return null;var e=_t.create(r,function(t){return t!==null&&(t=mi(t)),t});return e.parse()},Vo=function(r){return r?gt.parse(r,Bt(yi)):null},wr=function(r){return parseInt(r,10)},gi=function(r){var e=String(r);return/^\d+$/.test(e)?e:r},pi=function(r){return r?gt.parse(r,Bt(JSON.parse)):null},Sr=function(r){return r[0]!=="("?null:(r=r.substring(1,r.length-1).split(","),{x:parseFloat(r[0]),y:parseFloat(r[1])})},jo=function(r){if(r[0]!=="<"&&r[1]!=="(")return null;for(var e="(",t="",n=!1,i=2;i<r.length-1;i++){if(n||(e+=r[i]),r[i]===")"){n=!0;continue}else if(!n)continue;r[i]!==","&&(t+=r[i])}var s=Sr(e);return s.radius=parseFloat(t),s},Wo=function(r){r(20,gi),r(21,wr),r(23,wr),r(26,wr),r(700,parseFloat),r(701,parseFloat),r(16,vi),r(1082,kt),r(1114,kt),r(1184,kt),r(600,Sr),r(651,de),r(718,jo),r(1e3,ko),r(1001,Vo),r(1005,gr),r(1007,gr),r(1028,gr),r(1016,Uo),r(1017,Qo),r(1021,_r),r(1022,_r),r(1231,_r),r(1014,de),r(1015,de),r(1008,de),r(1009,de),r(1040,de),r(1041,de),r(1115,Er),r(1182,Er),r(1185,Er),r(1186,mi),r(1187,$o),r(17,yi),r(114,JSON.parse.bind(JSON)),r(3802,JSON.parse.bind(JSON)),r(199,pi),r(3807,pi),r(3907,de),r(2951,de),r(791,de),r(1183,de),r(1270,de)};_i.exports={init:Wo}});var Si=I((Yf,wi)=>{"use strict";d();var se=1e6;function Ho(r){var e=r.readInt32BE(0),t=r.readUInt32BE(4),n="";e<0&&(e=~e+(t===0),t=~t+1>>>0,n="-");var i="",s,a,l,o,f,h;{if(s=e%se,e=e/se>>>0,a=4294967296*s+t,t=a/se>>>0,l=""+(a-se*t),t===0&&e===0)return n+l+i;for(o="",f=6-l.length,h=0;h<f;h++)o+="0";i=o+l+i}{if(s=e%se,e=e/se>>>0,a=4294967296*s+t,t=a/se>>>0,l=""+(a-se*t),t===0&&e===0)return n+l+i;for(o="",f=6-l.length,h=0;h<f;h++)o+="0";i=o+l+i}{if(s=e%se,e=e/se>>>0,a=4294967296*s+t,t=a/se>>>0,l=""+(a-se*t),t===0&&e===0)return n+l+i;for(o="",f=6-l.length,h=0;h<f;h++)o+="0";i=o+l+i}return s=e%se,a=4294967296*s+t,l=""+a%se,n+l+i}wi.exports=Ho});var Ii=I((Jf,Ri)=>{d();var Go=Si(),Q=function(r,e,t,n,i){t=t||0,n=n||!1,i=i||function(D,k,K){return D*Math.pow(2,K)+k};var s=t>>3,a=function(D){return n?~D&255:D},l=255,o=8-t%8;e<o&&(l=255<<8-e&255,o=e),t&&(l=l>>t%8);var f=0;t%8+e>=8&&(f=i(0,a(r[s])&l,o));for(var h=e+t>>3,y=s+1;y<h;y++)f=i(f,a(r[y]),8);var E=(e+t)%8;return E>0&&(f=i(f,a(r[h])>>8-E,E)),f},Ai=function(r,e,t){var n=Math.pow(2,t-1)-1,i=Q(r,1),s=Q(r,t,1);if(s===0)return 0;var a=1,l=function(f,h,y){f===0&&(f=1);for(var E=1;E<=y;E++)a/=2,(h&1<<y-E)>0&&(f+=a);return f},o=Q(r,e,t+1,!1,l);return s==Math.pow(2,t+1)-1?o===0?i===0?1/0:-1/0:NaN:(i===0?1:-1)*Math.pow(2,s-n)*o},zo=function(r){return Q(r,1)==1?-1*(Q(r,15,1,!0)+1):Q(r,15,1)},bi=function(r){return Q(r,1)==1?-1*(Q(r,31,1,!0)+1):Q(r,31,1)},Ko=function(r){return Ai(r,23,8)},Yo=function(r){return Ai(r,52,11)},Jo=function(r){var e=Q(r,16,32);if(e==49152)return NaN;for(var t=Math.pow(1e4,Q(r,16,16)),n=0,i=[],s=Q(r,16),a=0;a<s;a++)n+=Q(r,16,64+16*a)*t,t/=1e4;var l=Math.pow(10,Q(r,16,48));return(e===0?1:-1)*Math.round(n*l)/l},xi=function(r,e){var t=Q(e,1),n=Q(e,63,1),i=new Date((t===0?1:-1)*n/1e3+9466848e5);return r||i.setTime(i.getTime()+i.getTimezoneOffset()*6e4),i.usec=n%1e3,i.getMicroSeconds=function(){return this.usec},i.setMicroSeconds=function(s){this.usec=s},i.getUTCMicroSeconds=function(){return this.usec},i},Et=function(r){for(var e=Q(r,32),t=Q(r,32,32),n=Q(r,32,64),i=96,s=[],a=0;a<e;a++)s[a]=Q(r,32,i),i+=32,i+=32;var l=function(f){var h=Q(r,32,i);if(i+=32,h==4294967295)return null;var y;if(f==23||f==20)return y=Q(r,h*8,i),i+=h*8,y;if(f==25)return y=r.toString(this.encoding,i>>3,(i+=h<<3)>>3),y;console.log("ERROR: ElementType not implemented: "+f)},o=function(f,h){var y=[],E;if(f.length>1){var D=f.shift();for(E=0;E<D;E++)y[E]=o(f,h);f.unshift(D)}else for(E=0;E<f[0];E++)y[E]=l(h);return y};return o(s,n)},Xo=function(r){return r.toString("utf8")},Zo=function(r){return r===null?null:Q(r,8)>0},el=function(r){r(20,Go),r(21,zo),r(23,bi),r(26,bi),r(1700,Jo),r(700,Ko),r(701,Yo),r(16,Zo),r(1114,xi.bind(null,!1)),r(1184,xi.bind(null,!0)),r(1e3,Et),r(1007,Et),r(1016,Et),r(1008,Et),r(1009,Et),r(25,Xo)};Ri.exports={init:el}});var Ci=I((Xf,Ti)=>{d();Ti.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}});var bt=I(St=>{d();var tl=Ei(),rl=Ii(),nl=mr(),il=Ci();St.getTypeParser=sl;St.setTypeParser=al;St.arrayParser=nl;St.builtins=il;var wt={text:{},binary:{}};function Pi(r){return String(r)}function sl(r,e){return e=e||"text",wt[e]&&wt[e][r]||Pi}function al(r,e,t){typeof e=="function"&&(t=e,e="text"),wt[e][r]=t}tl.init(function(r,e){wt.text[r]=e});rl.init(function(r,e){wt.binary[r]=e})});var xt=I((ed,br)=>{"use strict";d();br.exports={host:"localhost",user:process.platform==="win32"?process.env.USERNAME:process.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var Je=bt(),ol=Je.getTypeParser(20,"text"),ll=Je.getTypeParser(1016,"text");br.exports.__defineSetter__("parseInt8",function(r){Je.setTypeParser(20,"text",r?Je.getTypeParser(23,"text"):ol),Je.setTypeParser(1016,"text",r?Je.getTypeParser(1007,"text"):ll)})});var Qt=I((td,Oi)=>{"use strict";d();var ul=(hr(),z(dr)),cl=xt();function fl(r){var e=r.replace(/\\/g,"\\\\").replace(/"/g,'\\"');return'"'+e+'"'}function Di(r){for(var e="{",t=0;t<r.length;t++)t>0&&(e=e+","),r[t]===null||typeof r[t]>"u"?e=e+"NULL":Array.isArray(r[t])?e=e+Di(r[t]):r[t]instanceof Buffer?e+="\\\\x"+r[t].toString("hex"):e+=fl(Ut(r[t]));return e=e+"}",e}var Ut=function(r,e){if(r==null)return null;if(r instanceof Buffer)return r;if(ArrayBuffer.isView(r)){var t=Buffer.from(r.buffer,r.byteOffset,r.byteLength);return t.length===r.byteLength?t:t.slice(r.byteOffset,r.byteOffset+r.byteLength)}return r instanceof Date?cl.parseInputDatesAsUTC?pl(r):hl(r):Array.isArray(r)?Di(r):typeof r=="object"?dl(r,e):r.toString()};function dl(r,e){if(r&&typeof r.toPostgres=="function"){if(e=e||[],e.indexOf(r)!==-1)throw new Error('circular reference detected while preparing "'+r+'" for query');return e.push(r),Ut(r.toPostgres(Ut),e)}return JSON.stringify(r)}function te(r,e){for(r=""+r;r.length<e;)r="0"+r;return r}function hl(r){var e=-r.getTimezoneOffset(),t=r.getFullYear(),n=t<1;n&&(t=Math.abs(t)+1);var i=te(t,4)+"-"+te(r.getMonth()+1,2)+"-"+te(r.getDate(),2)+"T"+te(r.getHours(),2)+":"+te(r.getMinutes(),2)+":"+te(r.getSeconds(),2)+"."+te(r.getMilliseconds(),3);return e<0?(i+="-",e*=-1):i+="+",i+=te(Math.floor(e/60),2)+":"+te(e%60,2),n&&(i+=" BC"),i}function pl(r){var e=r.getUTCFullYear(),t=e<1;t&&(e=Math.abs(e)+1);var n=te(e,4)+"-"+te(r.getUTCMonth()+1,2)+"-"+te(r.getUTCDate(),2)+"T"+te(r.getUTCHours(),2)+":"+te(r.getUTCMinutes(),2)+":"+te(r.getUTCSeconds(),2)+"."+te(r.getUTCMilliseconds(),3);return n+="+00:00",t&&(n+=" BC"),n}function ml(r,e,t){return r=typeof r=="string"?{text:r}:r,e&&(typeof e=="function"?r.callback=e:r.values=e),t&&(r.callback=t),r}var xr=function(r){return ul.createHash("md5").update(r,"utf-8").digest("hex")},yl=function(r,e,t){var n=xr(e+r),i=xr(Buffer.concat([Buffer.from(n),t]));return"md5"+i};Oi.exports={prepareValue:function(e){return Ut(e)},normalizeQueryConfig:ml,postgresMd5PasswordHash:yl,md5:xr}});var Fi=I((rd,Mi)=>{"use strict";d();var Ar=(hr(),z(dr));function vl(r){if(r.indexOf("SCRAM-SHA-256")===-1)throw new Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let e=Ar.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:e,response:"n,,n=*,r="+e,message:"SASLInitialResponse"}}function gl(r,e,t){if(r.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof e!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(typeof t!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let n=wl(t);if(n.nonce.startsWith(r.clientNonce)){if(n.nonce.length===r.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var i=Buffer.from(n.salt,"base64"),s=xl(e,i,n.iteration),a=Xe(s,"Client Key"),l=bl(a),o="n=*,r="+r.clientNonce,f="r="+n.nonce+",s="+n.salt+",i="+n.iteration,h="c=biws,r="+n.nonce,y=o+","+f+","+h,E=Xe(l,y),D=Li(a,E),k=D.toString("base64"),K=Xe(s,"Server Key"),_e=Xe(K,y);r.message="SASLResponse",r.serverSignature=_e.toString("base64"),r.response=h+",p="+k}function _l(r,e){if(r.message!=="SASLResponse")throw new Error("SASL: Last message was not SASLResponse");if(typeof e!="string")throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:t}=Sl(e);if(t!==r.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}function El(r){if(typeof r!="string")throw new TypeError("SASL: text must be a string");return r.split("").map((e,t)=>r.charCodeAt(t)).every(e=>e>=33&&e<=43||e>=45&&e<=126)}function Ni(r){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(r)}function qi(r){if(typeof r!="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map(r.split(",").map(e=>{if(!/^.=/.test(e))throw new Error("SASL: Invalid attribute pair entry");let t=e[0],n=e.substring(2);return[t,n]}))}function wl(r){let e=qi(r),t=e.get("r");if(t){if(!El(t))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let n=e.get("s");if(n){if(!Ni(n))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let i=e.get("i");if(i){if(!/^[1-9][0-9]*$/.test(i))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");let s=parseInt(i,10);return{nonce:t,salt:n,iteration:s}}function Sl(r){let t=qi(r).get("v");if(t){if(!Ni(t))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:t}}function Li(r,e){if(!Buffer.isBuffer(r))throw new TypeError("first argument must be a Buffer");if(!Buffer.isBuffer(e))throw new TypeError("second argument must be a Buffer");if(r.length!==e.length)throw new Error("Buffer lengths must match");if(r.length===0)throw new Error("Buffers cannot be empty");return Buffer.from(r.map((t,n)=>r[n]^e[n]))}function bl(r){return Ar.createHash("sha256").update(r).digest()}function Xe(r,e){return Ar.createHmac("sha256",r).update(e).digest()}function xl(r,e,t){for(var n=Xe(r,Buffer.concat([e,Buffer.from([0,0,0,1])])),i=n,s=0;s<t-1;s++)n=Xe(r,n),i=Li(i,n);return i}Mi.exports={startSession:vl,continueSession:gl,finalizeSession:_l}});var Rr={};fe(Rr,{default:()=>Al});var Al,Ir=re(()=>{d();Al={}});var Tr={};fe(Tr,{default:()=>Rl});var Rl,Cr=re(()=>{d();Rl={}});var Pr={};fe(Pr,{default:()=>Il});var Il,Dr=re(()=>{d();Il={}});var ki={};fe(ki,{StringDecoder:()=>Or});var Or,Bi=re(()=>{d();Or=class{constructor(e){this.td=new TextDecoder(e)}write(e){return this.td.decode(e,{stream:!0})}end(e){return this.td.decode(e)}}});var Vi=I((nd,$i)=>{"use strict";d();var{Transform:Tl}=(Dr(),z(Pr)),{StringDecoder:Cl}=(Bi(),z(ki)),Me=Symbol("last"),$t=Symbol("decoder");function Pl(r,e,t){let n;if(this.overflow){if(n=this[$t].write(r).split(this.matcher),n.length===1)return t();n.shift(),this.overflow=!1}else this[Me]+=this[$t].write(r),n=this[Me].split(this.matcher);this[Me]=n.pop();for(let i=0;i<n.length;i++)try{Qi(this,this.mapper(n[i]))}catch(s){return t(s)}if(this.overflow=this[Me].length>this.maxLength,this.overflow&&!this.skipOverflow){t(new Error("maximum buffer reached"));return}t()}function Dl(r){if(this[Me]+=this[$t].end(),this[Me])try{Qi(this,this.mapper(this[Me]))}catch(e){return r(e)}r()}function Qi(r,e){e!==void 0&&r.push(e)}function Ui(r){return r}function Ol(r,e,t){switch(r=r||/\r?\n/,e=e||Ui,t=t||{},arguments.length){case 1:typeof r=="function"?(e=r,r=/\r?\n/):typeof r=="object"&&!(r instanceof RegExp)&&(t=r,r=/\r?\n/);break;case 2:typeof r=="function"?(t=e,e=r,r=/\r?\n/):typeof e=="object"&&(t=e,e=Ui)}t=Object.assign({},t),t.autoDestroy=!0,t.transform=Pl,t.flush=Dl,t.readableObjectMode=!0;let n=new Tl(t);return n[Me]="",n[$t]=new Cl("utf8"),n.matcher=r,n.mapper=e,n.maxLength=t.maxLength,n.skipOverflow=t.skipOverflow||!1,n.overflow=!1,n._destroy=function(i,s){this._writableState.errorEmitted=!1,s(i)},n}$i.exports=Ol});var Hi=I((id,Ie)=>{"use strict";d();var ji=(Ir(),z(Rr)),Nl=(Dr(),z(Pr)).Stream,ql=Vi(),Wi=(mt(),z(pt)),Ll=5432,Vt=process.platform==="win32",At=process.stderr,Ml=56,Fl=7,kl=61440,Bl=32768;function Ul(r){return(r&kl)==Bl}var Ze=["host","port","database","user","password"],Nr=Ze.length,Ql=Ze[Nr-1];function qr(){var r=At instanceof Nl&&At.writable===!0;if(r){var e=Array.prototype.slice.call(arguments).concat(`
`);At.write(Wi.format.apply(Wi,e))}}Object.defineProperty(Ie.exports,"isWin",{get:function(){return Vt},set:function(r){Vt=r}});Ie.exports.warnTo=function(r){var e=At;return At=r,e};Ie.exports.getFileName=function(r){var e=r||process.env,t=e.PGPASSFILE||(Vt?ji.join(e.APPDATA||"./","postgresql","pgpass.conf"):ji.join(e.HOME||"./",".pgpass"));return t};Ie.exports.usePgPass=function(r,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:Vt?!0:(e=e||"<unkn>",Ul(r.mode)?r.mode&(Ml|Fl)?(qr('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(qr('WARNING: password file "%s" is not a plain file',e),!1))};var $l=Ie.exports.match=function(r,e){return Ze.slice(0,-1).reduce(function(t,n,i){return i==1&&Number(r[n]||Ll)===Number(e[n])?t&&!0:t&&(e[n]==="*"||e[n]===r[n])},!0)};Ie.exports.getPassword=function(r,e,t){var n,i=e.pipe(ql());function s(o){var f=Vl(o);f&&jl(f)&&$l(r,f)&&(n=f[Ql],i.end())}var a=function(){e.destroy(),t(n)},l=function(o){e.destroy(),qr("WARNING: error on reading file: %s",o),t(void 0)};e.on("error",l),i.on("data",s).on("end",a).on("error",l)};var Vl=Ie.exports.parseLine=function(r){if(r.length<11||r.match(/^\s+#/))return null;for(var e="",t="",n=0,i=0,s=0,a={},l=!1,o=function(h,y,E){var D=r.substring(y,E);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(D=D.replace(/\\([:\\])/g,"$1")),a[Ze[h]]=D},f=0;f<r.length-1;f+=1){if(e=r.charAt(f+1),t=r.charAt(f),l=n==Nr-1,l){o(n,i);break}f>=0&&e==":"&&t!=="\\"&&(o(n,i,f+1),i=f+2,n+=1)}return a=Object.keys(a).length===Nr?a:null,a},jl=Ie.exports.isValidEntry=function(r){for(var e={0:function(a){return a.length>0},1:function(a){return a==="*"?!0:(a=Number(a),isFinite(a)&&a>0&&a<9007199254740992&&Math.floor(a)===a)},2:function(a){return a.length>0},3:function(a){return a.length>0},4:function(a){return a.length>0}},t=0;t<Ze.length;t+=1){var n=e[t],i=r[Ze[t]]||"",s=n(i);if(!s)return!1}return!0}});var zi=I((ad,Lr)=>{"use strict";d();var sd=(Ir(),z(Rr)),Gi=(Cr(),z(Tr)),jt=Hi();Lr.exports=function(r,e){var t=jt.getFileName();Gi.stat(t,function(n,i){if(n||!jt.usePgPass(i,t))return e(void 0);var s=Gi.createReadStream(t);jt.getPassword(r,s,e)})};Lr.exports.warnTo=jt.warnTo});var Mr=I((od,Ki)=>{"use strict";d();var Wl=bt();function Wt(r){this._types=r||Wl,this.text={},this.binary={}}Wt.prototype.getOverrides=function(r){switch(r){case"text":return this.text;case"binary":return this.binary;default:return{}}};Wt.prototype.setTypeParser=function(r,e,t){typeof e=="function"&&(t=e,e="text"),this.getOverrides(e)[r]=t};Wt.prototype.getTypeParser=function(r,e){return e=e||"text",this.getOverrides(e)[r]||this._types.getTypeParser(r,e)};Ki.exports=Wt});var Yi={};fe(Yi,{default:()=>Hl});var Hl,Ji=re(()=>{d();Hl={}});var Xi={};fe(Xi,{parse:()=>Gl});function Gl(r,e=!1){let{protocol:t}=new URL(r),n="http:"+r.substring(t.length),{username:i,password:s,hostname:a,port:l,pathname:o,search:f,searchParams:h,hash:y}=new URL(n);s=decodeURIComponent(s);let E=i+":"+s,D=e?Object.fromEntries(h.entries()):f;return{href:r,protocol:t,auth:E,username:i,password:s,hostname:a,port:l,pathname:o,search:f,query:D,hash:y}}var Zi=re(()=>{d()});var Br=I((ld,es)=>{"use strict";d();var zl=(Zi(),z(Xi)),Fr=(Cr(),z(Tr));function kr(r){if(r.charAt(0)==="/"){var t=r.split(" ");return{host:t[0],database:t[1]}}var e=zl.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(r)?encodeURI(r).replace(/\%25(\d\d)/g,"%$1"):r,!0),t=e.query;for(var n in t)Array.isArray(t[n])&&(t[n]=t[n][t[n].length-1]);var i=(e.auth||":").split(":");if(t.user=i[0],t.password=i.splice(1).join(":"),t.port=e.port,e.protocol=="socket:")return t.host=decodeURI(e.pathname),t.database=e.query.db,t.client_encoding=e.query.encoding,t;t.host||(t.host=e.hostname);var s=e.pathname;if(!t.host&&s&&/^%2f/i.test(s)){var a=s.split("/");t.host=decodeURIComponent(a[0]),s=a.splice(1).join("/")}switch(s&&s.charAt(0)==="/"&&(s=s.slice(1)||null),t.database=s&&decodeURI(s),(t.ssl==="true"||t.ssl==="1")&&(t.ssl=!0),t.ssl==="0"&&(t.ssl=!1),(t.sslcert||t.sslkey||t.sslrootcert||t.sslmode)&&(t.ssl={}),t.sslcert&&(t.ssl.cert=Fr.readFileSync(t.sslcert).toString()),t.sslkey&&(t.ssl.key=Fr.readFileSync(t.sslkey).toString()),t.sslrootcert&&(t.ssl.ca=Fr.readFileSync(t.sslrootcert).toString()),t.sslmode){case"disable":{t.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{t.ssl.rejectUnauthorized=!1;break}}return t}es.exports=kr;kr.parse=kr});var Qr=I((ud,ns)=>{"use strict";d();var Kl=(Ji(),z(Yi)),rs=xt(),ts=Br().parse,ne=function(r,e,t){return t===void 0?t=process.env["PG"+r.toUpperCase()]:t===!1||(t=process.env[t]),e[r]||t||rs[r]},Yl=function(){switch(process.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return rs.ssl},et=function(r){return"'"+(""+r).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},he=function(r,e,t){var n=e[t];n!=null&&r.push(t+"="+et(n))},Ur=class{constructor(e){e=typeof e=="string"?ts(e):e||{},e.connectionString&&(e=Object.assign({},e,ts(e.connectionString))),this.user=ne("user",e),this.database=ne("database",e),this.database===void 0&&(this.database=this.user),this.port=parseInt(ne("port",e),10),this.host=ne("host",e),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:ne("password",e)}),this.binary=ne("binary",e),this.options=ne("options",e),this.ssl=typeof e.ssl>"u"?Yl():e.ssl,typeof this.ssl=="string"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=ne("client_encoding",e),this.replication=ne("replication",e),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=ne("application_name",e,"PGAPPNAME"),this.fallback_application_name=ne("fallback_application_name",e,!1),this.statement_timeout=ne("statement_timeout",e,!1),this.lock_timeout=ne("lock_timeout",e,!1),this.idle_in_transaction_session_timeout=ne("idle_in_transaction_session_timeout",e,!1),this.query_timeout=ne("query_timeout",e,!1),e.connectionTimeoutMillis===void 0?this.connect_timeout=process.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(e.connectionTimeoutMillis/1e3),e.keepAlive===!1?this.keepalives=0:e.keepAlive===!0&&(this.keepalives=1),typeof e.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(e.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(e){var t=[];he(t,this,"user"),he(t,this,"password"),he(t,this,"port"),he(t,this,"application_name"),he(t,this,"fallback_application_name"),he(t,this,"connect_timeout"),he(t,this,"options");var n=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(he(t,n,"sslmode"),he(t,n,"sslca"),he(t,n,"sslkey"),he(t,n,"sslcert"),he(t,n,"sslrootcert"),this.database&&t.push("dbname="+et(this.database)),this.replication&&t.push("replication="+et(this.replication)),this.host&&t.push("host="+et(this.host)),this.isDomainSocket)return e(null,t.join(" "));this.client_encoding&&t.push("client_encoding="+et(this.client_encoding)),Kl.lookup(this.host,function(i,s){return i?e(i,null):(t.push("hostaddr="+et(s)),e(null,t.join(" ")))})}};ns.exports=Ur});var as=I((cd,ss)=>{"use strict";d();var Jl=bt(),is=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,$r=class{constructor(e,t){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=t,this.RowCtor=null,this.rowAsArray=e==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(e){var t;e.text?t=is.exec(e.text):t=is.exec(e.command),t&&(this.command=t[1],t[3]?(this.oid=parseInt(t[2],10),this.rowCount=parseInt(t[3],10)):t[2]&&(this.rowCount=parseInt(t[2],10)))}_parseRowAsArray(e){for(var t=new Array(e.length),n=0,i=e.length;n<i;n++){var s=e[n];s!==null?t[n]=this._parsers[n](s):t[n]=null}return t}parseRow(e){for(var t={},n=0,i=e.length;n<i;n++){var s=e[n],a=this.fields[n].name;s!==null?t[a]=this._parsers[n](s):t[a]=null}return t}addRow(e){this.rows.push(e)}addFields(e){this.fields=e,this.fields.length&&(this._parsers=new Array(e.length));for(var t=0;t<e.length;t++){var n=e[t];this._types?this._parsers[t]=this._types.getTypeParser(n.dataTypeID,n.format||"text"):this._parsers[t]=Jl.getTypeParser(n.dataTypeID,n.format||"text")}}};ss.exports=$r});var cs=I((fd,us)=>{"use strict";d();var{EventEmitter:Xl}=Le(),os=as(),ls=Qt(),Vr=class extends Xl{constructor(e,t,n){super(),e=ls.normalizeQueryConfig(e,t,n),this.text=e.text,this.values=e.values,this.rows=e.rows,this.types=e.types,this.name=e.name,this.binary=e.binary,this.portal=e.portal||"",this.callback=e.callback,this._rowMode=e.rowMode,process.domain&&e.callback&&(this.callback=process.domain.bind(e.callback)),this._result=new os(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new os(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(e){this._checkForMultirow(),this._result.addFields(e.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(e){let t;if(!this._canceledDueToError){try{t=this._result.parseRow(e.fields)}catch(n){this._canceledDueToError=n;return}this.emit("row",t,this._result),this._accumulateRows&&this._result.addRow(t)}}handleCommandComplete(e,t){this._checkForMultirow(),this._result.addCommandComplete(e),this.rows&&t.sync()}handleEmptyQuery(e){this.rows&&e.sync()}handleError(e,t){if(this._canceledDueToError&&(e=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(e);this.emit("error",e)}handleReadyForQuery(e){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,e);if(this.callback)try{this.callback(null,this._results)}catch(t){process.nextTick(()=>{throw t})}this.emit("end",this._results)}submit(e){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");let t=e.parsedStatements[this.name];return this.text&&t&&this.text!==t?new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`):this.values&&!Array.isArray(this.values)?new Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(e):e.query(this.text),null)}hasBeenParsed(e){return this.name&&e.parsedStatements[this.name]}handlePortalSuspended(e){this._getRows(e,this.rows)}_getRows(e,t){e.execute({portal:this.portal,rows:t}),t?e.flush():e.sync()}prepare(e){this.isPreparedStatement=!0,this.hasBeenParsed(e)||e.parse({text:this.text,name:this.name,types:this.types});try{e.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:ls.prepareValue})}catch(t){this.handleError(t,e);return}e.describe({type:"P",name:this.portal||""}),this._getRows(e,this.rows)}handleCopyInResponse(e){e.sendCopyFail("No source stream defined")}handleCopyData(e,t){}};us.exports=Vr});var fs,ds=re(()=>{"use strict";d();fs=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(e){e=e||{};var t=typeof e<"u"?e:{},n,i;t.ready=new Promise(function(u,c){n=u,i=c});var s=Object.assign({},t),a=[],l="./this.program",o=(u,c)=>{throw c},f=!0,h=!1,y="";function E(u){return t.locateFile?t.locateFile(u,y):y+u}var D,k,K,_e;(f||h)&&(h?y=self.location.href:typeof document<"u"&&document.currentScript&&(y=document.currentScript.src),r&&(y=r),y.indexOf("blob:")!==0?y=y.substr(0,y.replace(/[?#].*/,"").lastIndexOf("/")+1):y="",D=u=>{var c=new XMLHttpRequest;return c.open("GET",u,!1),c.send(null),c.responseText},h&&(K=u=>{var c=new XMLHttpRequest;return c.open("GET",u,!1),c.responseType="arraybuffer",c.send(null),new Uint8Array(c.response)}),k=(u,c,p)=>{var _=new XMLHttpRequest;_.open("GET",u,!0),_.responseType="arraybuffer",_.onload=()=>{if(_.status==200||_.status==0&&_.response){c(_.response);return}p()},_.onerror=p,_.send(null)},_e=u=>document.title=u);var Ae=t.print||console.log.bind(console),N=t.printErr||console.warn.bind(console);Object.assign(t,s),s=null,t.arguments&&(a=t.arguments),t.thisProgram&&(l=t.thisProgram),t.quit&&(o=t.quit);var S;t.wasmBinary&&(S=t.wasmBinary);var Ee=t.noExitRuntime||!0;typeof WebAssembly!="object"&&He("no native wasm support detected");var ue,H=!1,me;function we(u,c){u||He(c)}var Se=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function B(u,c,p){for(var _=c+p,R=c;u[R]&&!(R>=_);)++R;if(R-c>16&&u.buffer&&Se)return Se.decode(u.subarray(c,R));for(var P="";c<R;){var b=u[c++];if(!(b&128)){P+=String.fromCharCode(b);continue}var x=u[c++]&63;if((b&224)==192){P+=String.fromCharCode((b&31)<<6|x);continue}var L=u[c++]&63;if((b&240)==224?b=(b&15)<<12|x<<6|L:b=(b&7)<<18|x<<12|L<<6|u[c++]&63,b<65536)P+=String.fromCharCode(b);else{var W=b-65536;P+=String.fromCharCode(55296|W>>10,56320|W&1023)}}return P}function X(u,c){return u?B(G,u,c):""}function U(u,c,p,_){if(!(_>0))return 0;for(var R=p,P=p+_-1,b=0;b<u.length;++b){var x=u.charCodeAt(b);if(x>=55296&&x<=57343){var L=u.charCodeAt(++b);x=65536+((x&1023)<<10)|L&1023}if(x<=127){if(p>=P)break;c[p++]=x}else if(x<=2047){if(p+1>=P)break;c[p++]=192|x>>6,c[p++]=128|x&63}else if(x<=65535){if(p+2>=P)break;c[p++]=224|x>>12,c[p++]=128|x>>6&63,c[p++]=128|x&63}else{if(p+3>=P)break;c[p++]=240|x>>18,c[p++]=128|x>>12&63,c[p++]=128|x>>6&63,c[p++]=128|x&63}}return c[p]=0,p-R}function ce(u,c,p){return U(u,G,c,p)}function je(u){for(var c=0,p=0;p<u.length;++p){var _=u.charCodeAt(p);_<=127?c++:_<=2047?c+=2:_>=55296&&_<=57343?(c+=4,++p):c+=3}return c}var Pe,q,G,We,ir,Z,Re,fa,da;function In(u){Pe=u,t.HEAP8=q=new Int8Array(u),t.HEAP16=We=new Int16Array(u),t.HEAP32=Z=new Int32Array(u),t.HEAPU8=G=new Uint8Array(u),t.HEAPU16=ir=new Uint16Array(u),t.HEAPU32=Re=new Uint32Array(u),t.HEAPF32=fa=new Float32Array(u),t.HEAPF64=da=new Float64Array(u)}var qf=t.INITIAL_MEMORY||16777216,ha,Tn=[],Cn=[],Pn=[],pa=!1;function ma(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)ga(t.preRun.shift());ar(Tn)}function ya(){pa=!0,ar(Cn)}function va(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)Ea(t.postRun.shift());ar(Pn)}function ga(u){Tn.unshift(u)}function _a(u){Cn.unshift(u)}function Ea(u){Pn.unshift(u)}var Ue=0,sr=null,ft=null;function wa(u){Ue++,t.monitorRunDependencies&&t.monitorRunDependencies(Ue)}function Sa(u){if(Ue--,t.monitorRunDependencies&&t.monitorRunDependencies(Ue),Ue==0&&(sr!==null&&(clearInterval(sr),sr=null),ft)){var c=ft;ft=null,c()}}function He(u){t.onAbort&&t.onAbort(u),u="Aborted("+u+")",N(u),H=!0,me=1,u+=". Build with -sASSERTIONS for more info.";var c=new WebAssembly.RuntimeError(u);throw i(c),c}var ba="data:application/octet-stream;base64,";function Dn(u){return u.startsWith(ba)}var ye;ye="tls.wasm",Dn(ye)||(ye=E(ye));function On(u){try{if(u==ye&&S)return new Uint8Array(S);if(K)return K(u);throw"both async and sync fetching of the wasm failed"}catch(c){He(c)}}function xa(){return!S&&(f||h)&&typeof fetch=="function"?fetch(ye,{credentials:"same-origin"}).then(function(u){if(!u.ok)throw"failed to load wasm binary file at '"+ye+"'";return u.arrayBuffer()}).catch(function(){return On(ye)}):Promise.resolve().then(function(){return On(ye)})}function Aa(){var u={a:Ya};function c(b,x){var L=b.exports;L=w.instrumentWasmExports(L),t.asm=L,ue=t.asm.o,In(ue.buffer),ha=t.asm.x,_a(t.asm.p),Sa("wasm-instantiate")}wa("wasm-instantiate");function p(b){c(b.instance)}function _(b){return xa().then(function(x){return WebAssembly.instantiate(x,u)}).then(function(x){return x}).then(b,function(x){N("failed to asynchronously prepare wasm: "+x),He(x)})}function R(){return!S&&typeof WebAssembly.instantiateStreaming=="function"&&!Dn(ye)&&typeof fetch=="function"?fetch(ye,{credentials:"same-origin"}).then(function(b){var x=WebAssembly.instantiateStreaming(b,u);return x.then(p,function(L){return N("wasm streaming compile failed: "+L),N("falling back to ArrayBuffer instantiation"),_(p)})}):_(p)}if(t.instantiateWasm)try{var P=t.instantiateWasm(u,c);return P=w.instrumentWasmExports(P),P}catch(b){N("Module.instantiateWasm callback failed with error: "+b),i(b)}return R().catch(i),{}}function Ra(){return crypto.DigestStream===void 0?0:1}function Ia(u,c){return w.handleAsync(async()=>await t.provideEncryptedFromNetwork(u,c))}function Ta(u,c){return t.writeEncryptedToNetwork(u,c)}function Ca(u,c,p,_){return w.handleAsync(async()=>{if(c!==0){if(t._digestStream==null){let P=new crypto.DigestStream(`SHA-${u}`),b=P.getWriter();t._digestStream={stream:P,writer:b}}let R=t.HEAPU8.subarray(c,c+p);await t._digestStream.writer.write(R)}else{let{stream:R,writer:P}=t._digestStream;await P.close();let b=await R.digest,x=new Uint8Array(b);t.HEAPU8.set(x,_),t._digestStream=null}})}function Pa(u,c,p,_,R,P,b,x,L,W,oe){return w.handleAsync(async()=>{let De=t.HEAPU8.subarray(R,R+P),Oe=W<<3,ve=t.HEAPU8.subarray(b,b+x),Ne={name:"AES-GCM",iv:De,tagLength:Oe,additionalData:ve},qe=t.HEAPU8.subarray(p,p+_),Y=await crypto.subtle.importKey("raw",qe,{name:"AES-GCM"},!1,["encrypt"]),be=t.HEAPU8.subarray(u,u+c),Ge=await crypto.subtle.encrypt(Ne,Y,be),ze=new Uint8Array(Ge),dt=ze.subarray(0,c),cr=ze.subarray(c);t.HEAPU8.set(dt,oe),t.HEAPU8.set(cr,L)})}function Da(u,c,p,_,R,P,b,x,L,W,oe){return w.handleAsync(async()=>{let De=t.HEAPU8.subarray(R,R+P),Oe=W<<3,ve=t.HEAPU8.subarray(b,b+x),Ne={name:"AES-GCM",iv:De,tagLength:Oe,additionalData:ve},qe=t.HEAPU8.subarray(p,p+_),Y=await crypto.subtle.importKey("raw",qe,{name:"AES-GCM"},!1,["decrypt"]),be=t.HEAPU8.subarray(u,u+c),Ge=t.HEAPU8.subarray(L,L+W),ze=new Uint8Array(c+W);ze.set(be),ze.set(Ge,c);try{let dt=await crypto.subtle.decrypt(Ne,Y,ze),cr=new Uint8Array(dt);return t.HEAPU8.set(cr,oe),0}catch(dt){return console.log("decrypt error:",dt.message),-1}})}function Oa(u,c,p){let _=t.HEAPU8.subarray(c,c+p);return crypto.getRandomValues(_),0}function Na(u){this.name="ExitStatus",this.message="Program terminated with exit("+u+")",this.status=u}function ar(u){for(;u.length>0;)u.shift()(t)}function qa(u){return Re[u>>2]+Z[u+4>>2]*4294967296}function La(u,c){var p=new Date(qa(u)*1e3);Z[c>>2]=p.getUTCSeconds(),Z[c+4>>2]=p.getUTCMinutes(),Z[c+8>>2]=p.getUTCHours(),Z[c+12>>2]=p.getUTCDate(),Z[c+16>>2]=p.getUTCMonth(),Z[c+20>>2]=p.getUTCFullYear()-1900,Z[c+24>>2]=p.getUTCDay();var _=Date.UTC(p.getUTCFullYear(),0,1,0,0,0,0),R=(p.getTime()-_)/(1e3*60*60*24)|0;Z[c+28>>2]=R}function Nn(u){var c=je(u)+1,p=lr(c);return p&&U(u,q,p,c),p}function Ma(u,c,p){var _=new Date().getFullYear(),R=new Date(_,0,1),P=new Date(_,6,1),b=R.getTimezoneOffset(),x=P.getTimezoneOffset(),L=Math.max(b,x);Z[u>>2]=L*60,Z[c>>2]=Number(b!=x);function W(Ne){var qe=Ne.toTimeString().match(/\(([A-Za-z ]+)\)$/);return qe?qe[1]:"GMT"}var oe=W(R),De=W(P),Oe=Nn(oe),ve=Nn(De);x<b?(Re[p>>2]=Oe,Re[p+4>>2]=ve):(Re[p>>2]=ve,Re[p+4>>2]=Oe)}function or(u,c,p){or.called||(or.called=!0,Ma(u,c,p))}function Fa(){return Date.now()}function ka(){return 2147483648}function Ba(u){try{return ue.grow(u-Pe.byteLength+65535>>>16),In(ue.buffer),1}catch{}}function Ua(u){var c=G.length;u=u>>>0;var p=ka();if(u>p)return!1;let _=(L,W)=>L+(W-L%W)%W;for(var R=1;R<=4;R*=2){var P=c*(1+.2/R);P=Math.min(P,u+100663296);var b=Math.min(p,_(Math.max(u,P),65536)),x=Ba(b);if(x)return!0}return!1}var qn={varargs:void 0,get:function(){qn.varargs+=4;var u=Z[qn.varargs-4>>2];return u},getStr:function(u){var c=X(u);return c}};function Qa(u){return 52}function $a(u,c,p,_,R){return 70}var Va=[null,[],[]];function ja(u,c){var p=Va[u];c===0||c===10?((u===1?Ae:N)(B(p,0)),p.length=0):p.push(c)}function Wa(u,c,p,_){for(var R=0,P=0;P<p;P++){var b=Re[c>>2],x=Re[c+4>>2];c+=8;for(var L=0;L<x;L++)ja(u,G[b+L]);R+=x}return Re[_>>2]=R,0}function Nt(u){try{return u()}catch(c){He(c)}}function Ha(u){if(u instanceof Na||u=="unwind")return me;o(1,u)}function Ga(u){if(!H)try{u()}catch(c){Ha(c)}}function Lf(){}function Mf(){}var w={instrumentWasmImports:function(u){var c=["env.invoke_*","env.emscripten_sleep","env.emscripten_wget","env.emscripten_wget_data","env.emscripten_idb_load","env.emscripten_idb_store","env.emscripten_idb_delete","env.emscripten_idb_exists","env.emscripten_idb_load_blob","env.emscripten_idb_store_blob","env.SDL_Delay","env.emscripten_scan_registers","env.emscripten_lazy_load_code","env.emscripten_fiber_swap","wasi_snapshot_preview1.fd_sync","env.__wasi_fd_sync","env._emval_await","env._dlopen_js","env.__asyncjs__*"].map(_=>_.split(".")[1]);for(var p in u)(function(_){var R=u[_],P=R.sig;if(typeof R=="function")var b=c.indexOf(_)>=0||_.startsWith("__asyncjs__")})(p)},instrumentWasmExports:function(u){var c={};for(var p in u)(function(_){var R=u[_];typeof R=="function"?c[_]=function(){w.exportCallStack.push(_);try{return R.apply(null,arguments)}finally{if(!H){var P=w.exportCallStack.pop();we(P===_),w.maybeStopUnwind()}}}:c[_]=R})(p);return c},State:{Normal:0,Unwinding:1,Rewinding:2,Disabled:3},state:0,StackSize:4096,currData:null,handleSleepReturnValue:0,exportCallStack:[],callStackNameToId:{},callStackIdToName:{},callStackId:0,asyncPromiseHandlers:null,sleepCallbacks:[],getCallStackId:function(u){var c=w.callStackNameToId[u];return c===void 0&&(c=w.callStackId++,w.callStackNameToId[u]=c,w.callStackIdToName[c]=u),c},maybeStopUnwind:function(){w.currData&&w.state===w.State.Unwinding&&w.exportCallStack.length===0&&(w.state=w.State.Normal,Nt(Qn),typeof Fibers<"u"&&Fibers.trampoline())},whenDone:function(){return new Promise((u,c)=>{w.asyncPromiseHandlers={resolve:u,reject:c}})},allocateData:function(){var u=lr(12+w.StackSize);return w.setDataHeader(u,u+12,w.StackSize),w.setDataRewindFunc(u),u},setDataHeader:function(u,c,p){Z[u>>2]=c,Z[u+4>>2]=c+p},setDataRewindFunc:function(u){var c=w.exportCallStack[0],p=w.getCallStackId(c);Z[u+8>>2]=p},getDataRewindFunc:function(u){var c=Z[u+8>>2],p=w.callStackIdToName[c],_=t.asm[p];return _},doRewind:function(u){var c=w.getDataRewindFunc(u);return c()},handleSleep:function(u){if(!H){if(w.state===w.State.Normal){var c=!1,p=!1;u(_=>{if(!H&&(w.handleSleepReturnValue=_||0,c=!0,!!p)){w.state=w.State.Rewinding,Nt(()=>$n(w.currData)),typeof Browser<"u"&&Browser.mainLoop.func&&Browser.mainLoop.resume();var R,P=!1;try{R=w.doRewind(w.currData)}catch(L){R=L,P=!0}var b=!1;if(!w.currData){var x=w.asyncPromiseHandlers;x&&(w.asyncPromiseHandlers=null,(P?x.reject:x.resolve)(R),b=!0)}if(P&&!b)throw R}}),p=!0,c||(w.state=w.State.Unwinding,w.currData=w.allocateData(),typeof Browser<"u"&&Browser.mainLoop.func&&Browser.mainLoop.pause(),Nt(()=>Un(w.currData)))}else w.state===w.State.Rewinding?(w.state=w.State.Normal,Nt(Vn),Fn(w.currData),w.currData=null,w.sleepCallbacks.forEach(_=>Ga(_))):He("invalid state: "+w.state);return w.handleSleepReturnValue}},handleAsync:function(u){return w.handleSleep(c=>{u().then(c)})}};function Ln(u){var c=t["_"+u];return c}function za(u,c){q.set(u,c)}function Mn(u,c,p,_,R){var P={string:Y=>{var be=0;if(Y!=null&&Y!==0){var Ge=(Y.length<<2)+1;be=ur(Ge),ce(Y,be,Ge)}return be},array:Y=>{var be=ur(Y.length);return za(Y,be),be}};function b(Y){return c==="string"?X(Y):c==="boolean"?Boolean(Y):Y}var x=Ln(u),L=[],W=0;if(_)for(var oe=0;oe<_.length;oe++){var De=P[p[oe]];De?(W===0&&(W=kn()),L[oe]=De(_[oe])):L[oe]=_[oe]}var Oe=w.currData,ve=x.apply(null,L);function Ne(Y){return W!==0&&Bn(W),b(Y)}var qe=R&&R.async;return w.currData!=Oe?w.whenDone().then(Ne):(ve=Ne(ve),qe?Promise.resolve(ve):ve)}function Ka(u,c,p,_){p=p||[];var R=p.every(b=>b==="number"||b==="boolean"),P=c!=="string";return P&&R&&!_?Ln(u):function(){return Mn(u,c,p,arguments,_)}}var Ya={g:Da,h:Pa,n:Ia,f:Ca,c:La,d:or,e:Ra,b:Fa,j:Ua,l:Qa,i:$a,k:Wa,m:Ta,a:Oa},Ff=Aa(),Ja=t.___wasm_call_ctors=function(){return(Ja=t.___wasm_call_ctors=t.asm.p).apply(null,arguments)},Xa=t._initTls=function(){return(Xa=t._initTls=t.asm.q).apply(null,arguments)},Za=t._readData=function(){return(Za=t._readData=t.asm.r).apply(null,arguments)},eo=t._writeData=function(){return(eo=t._writeData=t.asm.s).apply(null,arguments)},to=t._pending=function(){return(to=t._pending=t.asm.t).apply(null,arguments)},ro=t._shutdown=function(){return(ro=t._shutdown=t.asm.u).apply(null,arguments)},lr=t._malloc=function(){return(lr=t._malloc=t.asm.v).apply(null,arguments)},Fn=t._free=function(){return(Fn=t._free=t.asm.w).apply(null,arguments)},kn=t.stackSave=function(){return(kn=t.stackSave=t.asm.y).apply(null,arguments)},Bn=t.stackRestore=function(){return(Bn=t.stackRestore=t.asm.z).apply(null,arguments)},ur=t.stackAlloc=function(){return(ur=t.stackAlloc=t.asm.A).apply(null,arguments)},Un=t._asyncify_start_unwind=function(){return(Un=t._asyncify_start_unwind=t.asm.B).apply(null,arguments)},Qn=t._asyncify_stop_unwind=function(){return(Qn=t._asyncify_stop_unwind=t.asm.C).apply(null,arguments)},$n=t._asyncify_start_rewind=function(){return($n=t._asyncify_start_rewind=t.asm.D).apply(null,arguments)},Vn=t._asyncify_stop_rewind=function(){return(Vn=t._asyncify_stop_rewind=t.asm.E).apply(null,arguments)},kf=t.___start_em_js=17392,Bf=t.___stop_em_js=20726;t.ccall=Mn,t.cwrap=Ka;var qt;ft=function u(){qt||jn(),qt||(ft=u)};function jn(u){if(u=u||a,Ue>0||(ma(),Ue>0))return;function c(){qt||(qt=!0,t.calledRun=!0,!H&&(ya(),n(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),va()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),c()},1)):c()}if(t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return jn(),e.ready}})()});var ps,hs=re(()=>{ps=`-----BEGIN CERTIFICATE-----
MIIFazCCA1OgAwIBAgIRAIIQz7DSQONZRGPgu2OCiwAwDQYJKoZIhvcNAQELBQAw
TzELMAkGA1UEBhMCVVMxKTAnBgNVBAoTIEludGVybmV0IFNlY3VyaXR5IFJlc2Vh
cmNoIEdyb3VwMRUwEwYDVQQDEwxJU1JHIFJvb3QgWDEwHhcNMTUwNjA0MTEwNDM4
WhcNMzUwNjA0MTEwNDM4WjBPMQswCQYDVQQGEwJVUzEpMCcGA1UEChMgSW50ZXJu
ZXQgU2VjdXJpdHkgUmVzZWFyY2ggR3JvdXAxFTATBgNVBAMTDElTUkcgUm9vdCBY
MTCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBAK3oJHP0FDfzm54rVygc
h77ct984kIxuPOZXoHj3dcKi/vVqbvYATyjb3miGbESTtrFj/RQSa78f0uoxmyF+
0TM8ukj13Xnfs7j/EvEhmkvBioZxaUpmZmyPfjxwv60pIgbz5MDmgK7iS4+3mX6U
A5/TR5d8mUgjU+g4rk8Kb4Mu0UlXjIB0ttov0DiNewNwIRt18jA8+o+u3dpjq+sW
T8KOEUt+zwvo/7V3LvSye0rgTBIlDHCNAymg4VMk7BPZ7hm/ELNKjD+Jo2FR3qyH
B5T0Y3HsLuJvW5iB4YlcNHlsdu87kGJ55tukmi8mxdAQ4Q7e2RCOFvu396j3x+UC
B5iPNgiV5+I3lg02dZ77DnKxHZu8A/lJBdiB3QW0KtZB6awBdpUKD9jf1b0SHzUv
KBds0pjBqAlkd25HN7rOrFleaJ1/ctaJxQZBKT5ZPt0m9STJEadao0xAH0ahmbWn
OlFuhjuefXKnEgV4We0+UXgVCwOPjdAvBbI+e0ocS3MFEvzG6uBQE3xDk3SzynTn
jh8BCNAw1FtxNrQHusEwMFxIt4I7mKZ9YIqioymCzLq9gwQbooMDQaHWBfEbwrbw
qHyGO0aoSCqI3Haadr8faqU9GY/rOPNk3sgrDQoo//fb4hVC1CLQJ13hef4Y53CI
rU7m2Ys6xt0nUW7/vGT1M0NPAgMBAAGjQjBAMA4GA1UdDwEB/wQEAwIBBjAPBgNV
HRMBAf8EBTADAQH/MB0GA1UdDgQWBBR5tFnme7bl5AFzgAiIyBpY9umbbjANBgkq
hkiG9w0BAQsFAAOCAgEAVR9YqbyyqFDQDLHYGmkgJykIrGF1XIpu+ILlaS/V9lZL
ubhzEFnTIZd+50xx+7LSYK05qAvqFyFWhfFQDlnrzuBZ6brJFe+GnY+EgPbk6ZGQ
3BebYhtF8GaV0nxvwuo77x/Py9auJ/GpsMiu/X1+mvoiBOv/2X/qkSsisRcOj/KK
NFtY2PwByVS5uCbMiogziUwthDyC3+6WVwW6LLv3xLfHTjuCvjHIInNzktHCgKQ5
ORAzI4JMPJ+GslWYHb4phowim57iaztXOoJwTdwJx4nLCgdNbOhdjsnvzqvHu7Ur
TkXWStAmzOVyyghqpZXjFaH3pO3JLF+l+/+sKAIuvtd7u+Nxe5AW0wdeRlN8NwdC
jNPElpzVmbUq4JUagEiuTDkHzsxHpFKVK7q4+63SM1N95R1NbdWhscdCb+ZAJzVc
oyi3B43njTOQ5yOf+1CceWxG1bQVs5ZufpsMljq4Ui0/1lvh+wjChP4kqKOJ2qxq
4RgqsahDYVvTH9w7jXbyLeiNdd8XM2w9U/t7y0Ff/9yi0GE44Za4rF2LN9d11TPA
mRGunUHBcnWEvgJBQl9nJEiU0Zsnvgc/ubhPgXRR4Xq37Z0j4r7g1SgEEzwxA57d
emyPxgcYxn/eR44/KJ4EBs+lVDR3veyJm+kXQ99b21/+jh5Xos1AnX5iItreGCc=
-----END CERTIFICATE-----
`});var ys={};fe(ys,{Socket:()=>ge,isIP:()=>eu});function eu(r){return 0}var ms,xe,ge,Ht=re(()=>{"use strict";d();ms=Lt(Le(),1);ds();hs();xe=class extends ms.EventEmitter{connecting=!1;pending=!0;writable=!0;encrypted=!1;authorized=!1;destroyed=!1;ws=null;module=null;tlsState=0;tlsWaitState=0;outstandingDataRequest=null;incomingDataQueue=[];writeQueue=[];setNoDelay(){}setKeepAlive(){}connect(e,t,n){this.connecting=!0,n&&this.once("connect",n);let s=`${typeof xe.wsProxy=="string"?xe.wsProxy:xe.wsProxy(t)}/v1?address=${t}:${e}`,a=new Promise(l=>{try{let o=new WebSocket("ws://"+s);o.addEventListener("open",()=>{l(o)})}catch{fetch("http://"+s,{headers:{Upgrade:"websocket"}}).then(f=>{let h=f.webSocket;if(h===null)throw new Error("Assumed Cloudflare Worker, but missing webSocket property on Response");h.accept(),l(h)})}});return Promise.all([a,fs({instantiateWasm:(l,o)=>(xe.wasmPath===void 0?import("./tlsImport-5SWPZKAM.js").then(f=>o(f.getWasmInstance(l))):WebAssembly.instantiateStreaming(fetch(xe.wasmPath),l).then(({instance:f})=>{o(f)}),{}),provideEncryptedFromNetwork:(l,o)=>new Promise(f=>{this.outstandingDataRequest={buffer:l,maxBytes:o,resolve:f},this.tlsTick()}),writeEncryptedToNetwork:(l,o)=>{let f=this.module.HEAPU8.slice(l,l+o);return this.ws.send(f),o}})]).then(([l,o])=>{this.module=o,this.ws=l,this.ws.binaryType="arraybuffer",this.ws.addEventListener("error",f=>{this.emit("error",f)}),this.ws.addEventListener("close",()=>{this.emit("close")}),this.ws.addEventListener("message",f=>{let h=Buffer.from(f.data);this.tlsState===0?this.emit("data",h):(this.incomingDataQueue.push(h),this.tlsTick())}),this.connecting=!1,this.pending=!1,this.emit("connect"),this.emit("ready")}),this}startTls(e){this.tlsState=1,this.module.ccall("initTls","number",["string","string","number","number"],[e,xe.rootCerts,xe.rootCerts.length,xe.disableSCRAM?1:0],{async:!0}).then(()=>{this.tlsState=2,this.encrypted=!0,this.authorized=!0,this.emit("secureConnection",this),this.tlsTick()})}tlsTick(){if(this.outstandingDataRequest!==null){if(this.incomingDataQueue.length===0)return;let i=this.incomingDataQueue[0],{buffer:s,maxBytes:a,resolve:l}=this.outstandingDataRequest;return i.length>a?(this.incomingDataQueue[0]=i.subarray(a),i=i.subarray(0,a)):this.incomingDataQueue.shift(),this.module.HEAPU8.set(i,s),this.outstandingDataRequest=null,l(i.length),this.tlsTick()}if(this.tlsState!==2||this.tlsWaitState!==0)return;let e=this.incomingDataQueue.reduce((i,s)=>i+s.length,0),t=this.module.ccall("pending","number",[],[]),n=e+t;if(n>0){this.tlsWaitState=1;let i=this.module._malloc(n);this.module.ccall("readData","number",["number","number"],[i,n],{async:!0}).then(s=>{if(this.tlsWaitState=0,s>0){let a=Buffer.alloc(s);a.set(this.module.HEAPU8.subarray(i,i+s)),this.module._free(i),this.emit("data",a),this.tlsTick()}else this.ws.close(),this.tlsState=3,this.emit("end")});return}if(this.writeQueue.length>0){this.tlsWaitState=2;let i=this.writeQueue.shift(),{data:s,callback:a}=i,l=s.length;this.module.ccall("writeData","number",["array","number"],[s,l],{async:!0}).then(()=>{this.tlsWaitState=0,a(),this.tlsTick()});return}else{this.emit("drain");return}}write(e,t="utf8",n=i=>{}){return e.length===0?n():(typeof e=="string"&&(e=Buffer.from(e,t)),this.tlsState===0?this.ws.send(e):(this.writeQueue.push({data:e,callback:n}),this.tlsTick()),!0)}end(e=Buffer.alloc(0),t="utf8",n){return this.write(e,t,()=>this.module.ccall("shutdown","number",[],[],{async:!0}).then(()=>{this.ws.close(),n&&n()})),this}destroy(){return this.destroyed=!0,this.end()}},ge=xe;ht(ge,"wsProxy","ws.neon.build"),ht(ge,"rootCerts",ps),ht(ge,"wasmPath"),ht(ge,"disableSCRAM",!0)});var sn=I(C=>{"use strict";d();Object.defineProperty(C,"__esModule",{value:!0});C.NoticeMessage=C.DataRowMessage=C.CommandCompleteMessage=C.ReadyForQueryMessage=C.NotificationResponseMessage=C.BackendKeyDataMessage=C.AuthenticationMD5Password=C.ParameterStatusMessage=C.ParameterDescriptionMessage=C.RowDescriptionMessage=C.Field=C.CopyResponse=C.CopyDataMessage=C.DatabaseError=C.copyDone=C.emptyQuery=C.replicationStart=C.portalSuspended=C.noData=C.closeComplete=C.bindComplete=C.parseComplete=void 0;C.parseComplete={name:"parseComplete",length:5};C.bindComplete={name:"bindComplete",length:5};C.closeComplete={name:"closeComplete",length:5};C.noData={name:"noData",length:5};C.portalSuspended={name:"portalSuspended",length:5};C.replicationStart={name:"replicationStart",length:4};C.emptyQuery={name:"emptyQuery",length:4};C.copyDone={name:"copyDone",length:4};var jr=class extends Error{constructor(e,t,n){super(e),this.length=t,this.name=n}};C.DatabaseError=jr;var Wr=class{constructor(e,t){this.length=e,this.chunk=t,this.name="copyData"}};C.CopyDataMessage=Wr;var Hr=class{constructor(e,t,n,i){this.length=e,this.name=t,this.binary=n,this.columnTypes=new Array(i)}};C.CopyResponse=Hr;var Gr=class{constructor(e,t,n,i,s,a,l){this.name=e,this.tableID=t,this.columnID=n,this.dataTypeID=i,this.dataTypeSize=s,this.dataTypeModifier=a,this.format=l}};C.Field=Gr;var zr=class{constructor(e,t){this.length=e,this.fieldCount=t,this.name="rowDescription",this.fields=new Array(this.fieldCount)}};C.RowDescriptionMessage=zr;var Kr=class{constructor(e,t){this.length=e,this.parameterCount=t,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}};C.ParameterDescriptionMessage=Kr;var Yr=class{constructor(e,t,n){this.length=e,this.parameterName=t,this.parameterValue=n,this.name="parameterStatus"}};C.ParameterStatusMessage=Yr;var Jr=class{constructor(e,t){this.length=e,this.salt=t,this.name="authenticationMD5Password"}};C.AuthenticationMD5Password=Jr;var Xr=class{constructor(e,t,n){this.length=e,this.processID=t,this.secretKey=n,this.name="backendKeyData"}};C.BackendKeyDataMessage=Xr;var Zr=class{constructor(e,t,n,i){this.length=e,this.processId=t,this.channel=n,this.payload=i,this.name="notification"}};C.NotificationResponseMessage=Zr;var en=class{constructor(e,t){this.length=e,this.status=t,this.name="readyForQuery"}};C.ReadyForQueryMessage=en;var tn=class{constructor(e,t){this.length=e,this.text=t,this.name="commandComplete"}};C.CommandCompleteMessage=tn;var rn=class{constructor(e,t){this.length=e,this.fields=t,this.name="dataRow",this.fieldCount=t.length}};C.DataRowMessage=rn;var nn=class{constructor(e,t){this.length=e,this.message=t,this.name="notice"}};C.NoticeMessage=nn});var vs=I(Gt=>{"use strict";d();Object.defineProperty(Gt,"__esModule",{value:!0});Gt.Writer=void 0;var an=class{constructor(e=256){this.size=e,this.offset=5,this.headerPosition=0,this.buffer=Buffer.allocUnsafe(e)}ensure(e){var t=this.buffer.length-this.offset;if(t<e){var n=this.buffer,i=n.length+(n.length>>1)+e;this.buffer=Buffer.allocUnsafe(i),n.copy(this.buffer)}}addInt32(e){return this.ensure(4),this.buffer[this.offset++]=e>>>24&255,this.buffer[this.offset++]=e>>>16&255,this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addInt16(e){return this.ensure(2),this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addCString(e){if(!e)this.ensure(1);else{var t=Buffer.byteLength(e);this.ensure(t+1),this.buffer.write(e,this.offset,"utf-8"),this.offset+=t}return this.buffer[this.offset++]=0,this}addString(e=""){var t=Buffer.byteLength(e);return this.ensure(t),this.buffer.write(e,this.offset),this.offset+=t,this}add(e){return this.ensure(e.length),e.copy(this.buffer,this.offset),this.offset+=e.length,this}join(e){if(e){this.buffer[this.headerPosition]=e;let t=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(t,this.headerPosition+1)}return this.buffer.slice(e?0:5,this.offset)}flush(e){var t=this.join(e);return this.offset=5,this.headerPosition=0,this.buffer=Buffer.allocUnsafe(this.size),t}};Gt.Writer=an});var _s=I(Kt=>{"use strict";d();Object.defineProperty(Kt,"__esModule",{value:!0});Kt.serialize=void 0;var on=vs(),$=new on.Writer,tu=r=>{$.addInt16(3).addInt16(0);for(let n of Object.keys(r))$.addCString(n).addCString(r[n]);$.addCString("client_encoding").addCString("UTF8");var e=$.addCString("").flush(),t=e.length+4;return new on.Writer().addInt32(t).add(e).flush()},ru=()=>{let r=Buffer.allocUnsafe(8);return r.writeInt32BE(8,0),r.writeInt32BE(80877103,4),r},nu=r=>$.addCString(r).flush(112),iu=function(r,e){return $.addCString(r).addInt32(Buffer.byteLength(e)).addString(e),$.flush(112)},su=function(r){return $.addString(r).flush(112)},au=r=>$.addCString(r).flush(81),gs=[],ou=r=>{let e=r.name||"";e.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",e,e.length),console.error("This can cause conflicts and silent errors executing queries"));let t=r.types||gs;for(var n=t.length,i=$.addCString(e).addCString(r.text).addInt16(n),s=0;s<n;s++)i.addInt32(t[s]);return $.flush(80)},tt=new on.Writer,lu=function(r,e){for(let t=0;t<r.length;t++){let n=e?e(r[t],t):r[t];n==null?($.addInt16(0),tt.addInt32(-1)):n instanceof Buffer?($.addInt16(1),tt.addInt32(n.length),tt.add(n)):($.addInt16(0),tt.addInt32(Buffer.byteLength(n)),tt.addString(n))}},uu=(r={})=>{let e=r.portal||"",t=r.statement||"",n=r.binary||!1,i=r.values||gs,s=i.length;return $.addCString(e).addCString(t),$.addInt16(s),lu(i,r.valueMapper),$.addInt16(s),$.add(tt.flush()),$.addInt16(n?1:0),$.flush(66)},cu=Buffer.from([69,0,0,0,9,0,0,0,0,0]),fu=r=>{if(!r||!r.portal&&!r.rows)return cu;let e=r.portal||"",t=r.rows||0,n=Buffer.byteLength(e),i=4+n+1+4,s=Buffer.allocUnsafe(1+i);return s[0]=69,s.writeInt32BE(i,1),s.write(e,5,"utf-8"),s[n+5]=0,s.writeUInt32BE(t,s.length-4),s},du=(r,e)=>{let t=Buffer.allocUnsafe(16);return t.writeInt32BE(16,0),t.writeInt16BE(1234,4),t.writeInt16BE(5678,6),t.writeInt32BE(r,8),t.writeInt32BE(e,12),t},ln=(r,e)=>{let t=Buffer.byteLength(e),n=4+t+1,i=Buffer.allocUnsafe(1+n);return i[0]=r,i.writeInt32BE(n,1),i.write(e,5,"utf-8"),i[n]=0,i},hu=$.addCString("P").flush(68),pu=$.addCString("S").flush(68),mu=r=>r.name?ln(68,`${r.type}${r.name||""}`):r.type==="P"?hu:pu,yu=r=>{let e=`${r.type}${r.name||""}`;return ln(67,e)},vu=r=>$.add(r).flush(100),gu=r=>ln(102,r),zt=r=>Buffer.from([r,0,0,0,4]),_u=zt(72),Eu=zt(83),wu=zt(88),Su=zt(99),bu={startup:tu,password:nu,requestSsl:ru,sendSASLInitialResponseMessage:iu,sendSCRAMClientFinalMessage:su,query:au,parse:ou,bind:uu,execute:fu,describe:mu,close:yu,flush:()=>_u,sync:()=>Eu,end:()=>wu,copyData:vu,copyDone:()=>Su,copyFail:gu,cancel:du};Kt.serialize=bu});var Es=I(Yt=>{"use strict";d();Object.defineProperty(Yt,"__esModule",{value:!0});Yt.BufferReader=void 0;var xu=Buffer.allocUnsafe(0),un=class{constructor(e=0){this.offset=e,this.buffer=xu,this.encoding="utf-8"}setBuffer(e,t){this.offset=e,this.buffer=t}int16(){let e=this.buffer.readInt16BE(this.offset);return this.offset+=2,e}byte(){let e=this.buffer[this.offset];return this.offset++,e}int32(){let e=this.buffer.readInt32BE(this.offset);return this.offset+=4,e}string(e){let t=this.buffer.toString(this.encoding,this.offset,this.offset+e);return this.offset+=e,t}cstring(){let e=this.offset,t=e;for(;this.buffer[t++]!==0;);return this.offset=t,this.buffer.toString(this.encoding,e,t-1)}bytes(e){let t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}};Yt.BufferReader=un});var ws={};fe(ws,{default:()=>Au});var Au,Ss=re(()=>{d();Au={}});var As=I(rt=>{"use strict";d();var Ru=rt&&rt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(rt,"__esModule",{value:!0});rt.Parser=void 0;var V=sn(),Iu=Es(),Tu=Ru((Ss(),z(ws))),cn=1,Cu=4,bs=cn+Cu,xs=Buffer.allocUnsafe(0),fn=class{constructor(e){if(this.buffer=xs,this.bufferLength=0,this.bufferOffset=0,this.reader=new Iu.BufferReader,e?.mode==="binary")throw new Error("Binary mode not supported yet");this.mode=e?.mode||"text"}parse(e,t){this.mergeBuffer(e);let n=this.bufferOffset+this.bufferLength,i=this.bufferOffset;for(;i+bs<=n;){let s=this.buffer[i],a=this.buffer.readUInt32BE(i+cn),l=cn+a;if(l+i<=n){let o=this.handlePacket(i+bs,s,a,this.buffer);t(o),i+=l}else break}i===n?(this.buffer=xs,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=n-i,this.bufferOffset=i)}mergeBuffer(e){if(this.bufferLength>0){let t=this.bufferLength+e.byteLength;if(t+this.bufferOffset>this.buffer.byteLength){let i;if(t<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)i=this.buffer;else{let s=this.buffer.byteLength*2;for(;t>=s;)s*=2;i=Buffer.allocUnsafe(s)}this.buffer.copy(i,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=i,this.bufferOffset=0}e.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=t}else this.buffer=e,this.bufferOffset=0,this.bufferLength=e.byteLength}handlePacket(e,t,n,i){switch(t){case 50:return V.bindComplete;case 49:return V.parseComplete;case 51:return V.closeComplete;case 110:return V.noData;case 115:return V.portalSuspended;case 99:return V.copyDone;case 87:return V.replicationStart;case 73:return V.emptyQuery;case 68:return this.parseDataRowMessage(e,n,i);case 67:return this.parseCommandCompleteMessage(e,n,i);case 90:return this.parseReadyForQueryMessage(e,n,i);case 65:return this.parseNotificationMessage(e,n,i);case 82:return this.parseAuthenticationResponse(e,n,i);case 83:return this.parseParameterStatusMessage(e,n,i);case 75:return this.parseBackendKeyData(e,n,i);case 69:return this.parseErrorMessage(e,n,i,"error");case 78:return this.parseErrorMessage(e,n,i,"notice");case 84:return this.parseRowDescriptionMessage(e,n,i);case 116:return this.parseParameterDescriptionMessage(e,n,i);case 71:return this.parseCopyInMessage(e,n,i);case 72:return this.parseCopyOutMessage(e,n,i);case 100:return this.parseCopyData(e,n,i);default:Tu.default.fail(`unknown message code: ${t.toString(16)}`)}}parseReadyForQueryMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.string(1);return new V.ReadyForQueryMessage(t,i)}parseCommandCompleteMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.cstring();return new V.CommandCompleteMessage(t,i)}parseCopyData(e,t,n){let i=n.slice(e,e+(t-4));return new V.CopyDataMessage(t,i)}parseCopyInMessage(e,t,n){return this.parseCopyMessage(e,t,n,"copyInResponse")}parseCopyOutMessage(e,t,n){return this.parseCopyMessage(e,t,n,"copyOutResponse")}parseCopyMessage(e,t,n,i){this.reader.setBuffer(e,n);let s=this.reader.byte()!==0,a=this.reader.int16(),l=new V.CopyResponse(t,i,s,a);for(let o=0;o<a;o++)l.columnTypes[o]=this.reader.int16();return l}parseNotificationMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int32(),s=this.reader.cstring(),a=this.reader.cstring();return new V.NotificationResponseMessage(t,i,s,a)}parseRowDescriptionMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int16(),s=new V.RowDescriptionMessage(t,i);for(let a=0;a<i;a++)s.fields[a]=this.parseField();return s}parseField(){let e=this.reader.cstring(),t=this.reader.int32(),n=this.reader.int16(),i=this.reader.int32(),s=this.reader.int16(),a=this.reader.int32(),l=this.reader.int16()===0?"text":"binary";return new V.Field(e,t,n,i,s,a,l)}parseParameterDescriptionMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int16(),s=new V.ParameterDescriptionMessage(t,i);for(let a=0;a<i;a++)s.dataTypeIDs[a]=this.reader.int32();return s}parseDataRowMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int16(),s=new Array(i);for(let a=0;a<i;a++){let l=this.reader.int32();s[a]=l===-1?null:this.reader.string(l)}return new V.DataRowMessage(t,s)}parseParameterStatusMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.cstring(),s=this.reader.cstring();return new V.ParameterStatusMessage(t,i,s)}parseBackendKeyData(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int32(),s=this.reader.int32();return new V.BackendKeyDataMessage(t,i,s)}parseAuthenticationResponse(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int32(),s={name:"authenticationOk",length:t};switch(i){case 0:break;case 3:s.length===8&&(s.name="authenticationCleartextPassword");break;case 5:if(s.length===12){s.name="authenticationMD5Password";let l=this.reader.bytes(4);return new V.AuthenticationMD5Password(t,l)}break;case 10:s.name="authenticationSASL",s.mechanisms=[];let a;do a=this.reader.cstring(),a&&s.mechanisms.push(a);while(a);break;case 11:s.name="authenticationSASLContinue",s.data=this.reader.string(t-8);break;case 12:s.name="authenticationSASLFinal",s.data=this.reader.string(t-8);break;default:throw new Error("Unknown authenticationOk message type "+i)}return s}parseErrorMessage(e,t,n,i){this.reader.setBuffer(e,n);let s={},a=this.reader.string(1);for(;a!=="\0";)s[a]=this.reader.cstring(),a=this.reader.string(1);let l=s.M,o=i==="notice"?new V.NoticeMessage(t,l):new V.DatabaseError(l,t,i);return o.severity=s.S,o.code=s.C,o.detail=s.D,o.hint=s.H,o.position=s.P,o.internalPosition=s.p,o.internalQuery=s.q,o.where=s.W,o.schema=s.s,o.table=s.t,o.column=s.c,o.dataType=s.d,o.constraint=s.n,o.file=s.F,o.line=s.L,o.routine=s.R,o}};rt.Parser=fn});var dn=I(Fe=>{"use strict";d();Object.defineProperty(Fe,"__esModule",{value:!0});Fe.DatabaseError=Fe.serialize=Fe.parse=void 0;var Pu=sn();Object.defineProperty(Fe,"DatabaseError",{enumerable:!0,get:function(){return Pu.DatabaseError}});var Du=_s();Object.defineProperty(Fe,"serialize",{enumerable:!0,get:function(){return Du.serialize}});var Ou=As();function Nu(r,e){let t=new Ou.Parser;return r.on("data",n=>t.parse(n,e)),new Promise(n=>r.on("end",()=>n()))}Fe.parse=Nu});var Rs={};fe(Rs,{connect:()=>qu});function qu(r){let{socket:e,servername:t}=r;return e.startTls(t),e}var Is=re(()=>{d()});var pn=I((Sd,Ps)=>{"use strict";d();var Ts=(Ht(),z(ys)),Lu=Le().EventEmitter,{parse:Mu,serialize:J}=dn(),Cs=J.flush(),Fu=J.sync(),ku=J.end(),hn=class extends Lu{constructor(e){super(),e=e||{},this.stream=e.stream||new Ts.Socket,this._keepAlive=e.keepAlive,this._keepAliveInitialDelayMillis=e.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=e.ssl||!1,this._ending=!1,this._emitMessage=!1;var t=this;this.on("newListener",function(n){n==="message"&&(t._emitMessage=!0)})}connect(e,t){var n=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(e,t),this.stream.once("connect",function(){n._keepAlive&&n.stream.setKeepAlive(!0,n._keepAliveInitialDelayMillis),n.emit("connect")});let i=function(s){n._ending&&(s.code==="ECONNRESET"||s.code==="EPIPE")||n.emit("error",s)};if(this.stream.on("error",i),this.stream.on("close",function(){n.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(s){var a=s.toString("utf8");switch(a){case"S":break;case"N":return n.stream.end(),n.emit("error",new Error("The server does not support SSL connections"));default:return n.stream.end(),n.emit("error",new Error("There was an error establishing an SSL connection"))}var l=(Is(),z(Rs));let o={socket:n.stream};n.ssl!==!0&&(Object.assign(o,n.ssl),"key"in n.ssl&&(o.key=n.ssl.key)),Ts.isIP(t)===0&&(o.servername=t);try{n.stream=l.connect(o)}catch(f){return n.emit("error",f)}n.attachListeners(n.stream),n.stream.on("error",i),n.emit("sslconnect")})}attachListeners(e){e.on("end",()=>{this.emit("end")}),Mu(e,t=>{var n=t.name==="error"?"errorMessage":t.name;this._emitMessage&&this.emit("message",t),this.emit(n,t)})}requestSsl(){this.stream.write(J.requestSsl())}startup(e){this.stream.write(J.startup(e))}cancel(e,t){this._send(J.cancel(e,t))}password(e){this._send(J.password(e))}sendSASLInitialResponseMessage(e,t){this._send(J.sendSASLInitialResponseMessage(e,t))}sendSCRAMClientFinalMessage(e){this._send(J.sendSCRAMClientFinalMessage(e))}_send(e){return this.stream.writable?this.stream.write(e):!1}query(e){this._send(J.query(e))}parse(e){this._send(J.parse(e))}bind(e){this._send(J.bind(e))}execute(e){this._send(J.execute(e))}flush(){this.stream.writable&&this.stream.write(Cs)}sync(){this._ending=!0,this._send(Cs),this._send(Fu)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(ku,()=>{this.stream.end()})}close(e){this._send(J.close(e))}describe(e){this._send(J.describe(e))}sendCopyFromChunk(e){this._send(J.copyData(e))}endCopyFrom(){this._send(J.copyDone())}sendCopyFail(e){this._send(J.copyFail(e))}};Ps.exports=hn});var Ns=I((xd,Os)=>{"use strict";d();var Bu=Le().EventEmitter,bd=(mt(),z(pt)),Uu=Qt(),mn=Fi(),Qu=zi(),$u=Mr(),Vu=Qr(),Ds=cs(),ju=xt(),Wu=pn(),Jt=class extends Bu{constructor(e){super(),this.connectionParameters=new Vu(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var t=e||{};this._Promise=t.Promise||global.Promise,this._types=new $u(t.types),this._ending=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=t.connection||new Wu({stream:t.stream,ssl:this.connectionParameters.ssl,keepAlive:t.keepAlive||!1,keepAliveInitialDelayMillis:t.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=t.binary||ju.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=t.connectionTimeoutMillis||0}_errorAllQueries(e){let t=n=>{process.nextTick(()=>{n.handleError(e,this.connection)})};this.activeQuery&&(t(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(t),this.queryQueue.length=0}_connect(e){var t=this,n=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let i=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(i)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{n._ending=!0,n.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){t.ssl?n.requestSsl():n.startup(t.getStartupConf())}),n.on("sslconnect",function(){n.startup(t.getStartupConf())}),this._attachListeners(n),n.once("end",()=>{let i=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(i),this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(i):this._handleErrorEvent(i):this._connectionError||this._handleErrorEvent(i)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((t,n)=>{this._connect(i=>{i?n(i):t()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let t=this.connection;typeof this.password=="function"?this._Promise.resolve().then(()=>this.password()).then(n=>{if(n!==void 0){if(typeof n!="string"){t.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=n}else this.connectionParameters.password=this.password=null;e()}).catch(n=>{t.emit("error",n)}):this.password!==null?e():Qu(this.connectionParameters,n=>{n!==void 0&&(this.connectionParameters.password=this.password=n),e()})}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(()=>{let t=Uu.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(t)})}_handleAuthSASL(e){this._checkPgPass(()=>{this.saslSession=mn.startSession(e.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)})}_handleAuthSASLContinue(e){mn.continueSession(this.saslSession,this.password,e.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}_handleAuthSASLFinal(e){mn.finalizeSession(this.saslSession,e.data),this.saslSession=null}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:t}=this;this.activeQuery=null,this.readyForQuery=!0,t&&t.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let t=this.activeQuery;if(!t){this._handleErrorEvent(e);return}this.activeQuery=null,t.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(e){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){var e=this.connectionParameters,t={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(t.application_name=n),e.replication&&(t.replication=""+e.replication),e.statement_timeout&&(t.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(t.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(t.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(t.options=e.options),t}cancel(e,t){if(e.activeQuery===t){var n=this.connection;this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){n.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(t)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(t),1)}setTypeParser(e,t,n){return this._types.setTypeParser(e,t,n)}getTypeParser(e,t){return this._types.getTypeParser(e,t)}escapeIdentifier(e){return'"'+e.replace(/"/g,'""')+'"'}escapeLiteral(e){for(var t=!1,n="'",i=0;i<e.length;i++){var s=e[i];s==="'"?n+=s+s:s==="\\"?(n+=s+s,t=!0):n+=s}return n+="'",t===!0&&(n=" E"+n),n}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,t,n){var i,s,a,l,o;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(a=e.query_timeout||this.connectionParameters.query_timeout,s=i=e,typeof t=="function"&&(i.callback=i.callback||t)):(a=this.connectionParameters.query_timeout,i=new Ds(e,t,n),i.callback||(s=new this._Promise((f,h)=>{i.callback=(y,E)=>y?h(y):f(E)}))),a&&(o=i.callback,l=setTimeout(()=>{var f=new Error("Query read timeout");process.nextTick(()=>{i.handleError(f,this.connection)}),o(f),i.callback=()=>{};var h=this.queryQueue.indexOf(i);h>-1&&this.queryQueue.splice(h,1),this._pulseQueryQueue()},a),i.callback=(f,h)=>{clearTimeout(l),o(f,h)}),this.binary&&!i.binary&&(i.binary=!0),i._result&&!i._result._types&&(i._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{i.handleError(new Error("Client was closed and is not queryable"),this.connection)}),s):(this.queryQueue.push(i),this._pulseQueryQueue(),s):(process.nextTick(()=>{i.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),s)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(t=>{this.connection.once("end",t)})}};Jt.Query=Ds;Os.exports=Jt});var Fs=I((Ad,Ms)=>{"use strict";d();var Hu=Le().EventEmitter,qs=function(){},Ls=(r,e)=>{let t=r.findIndex(e);return t===-1?void 0:r.splice(t,1)[0]},yn=class{constructor(e,t,n){this.client=e,this.idleListener=t,this.timeoutId=n}},nt=class{constructor(e){this.callback=e}};function Gu(){throw new Error("Release called on client which has already been released to the pool.")}function Xt(r,e){if(e)return{callback:e,result:void 0};let t,n,i=function(a,l){a?t(a):n(l)},s=new r(function(a,l){n=a,t=l});return{callback:i,result:s}}function zu(r,e){return function t(n){n.client=e,e.removeListener("error",t),e.on("error",()=>{r.log("additional client error after disconnection due to error",n)}),r._remove(e),r.emit("error",n,e)}}var vn=class extends Hu{constructor(e,t){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||t||Zt().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(t=>{this._remove(t.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let t=this._idle.pop();clearTimeout(t.timeoutId);let n=t.client;n.ref&&n.ref();let i=t.idleListener;return this._acquireClient(n,e,i,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e){let t=Ls(this._idle,n=>n.client===e);t!==void 0&&clearTimeout(t.timeoutId),this._clients=this._clients.filter(n=>n!==e),e.end(),this.emit("remove",e)}connect(e){if(this.ending){let i=new Error("Cannot use a pool after calling end on the pool");return e?e(i):this.Promise.reject(i)}let t=Xt(this.Promise,e),n=t.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new nt(t.callback)),n;let i=(l,o,f)=>{clearTimeout(a),t.callback(l,o,f)},s=new nt(i),a=setTimeout(()=>{Ls(this._pendingQueue,l=>l.callback===i),s.timedOut=!0,t.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return this._pendingQueue.push(s),n}return this.newClient(new nt(t.callback)),n}newClient(e){let t=new this.Client(this.options);this._clients.push(t);let n=zu(this,t);this.log("checking client timeout");let i,s=!1;this.options.connectionTimeoutMillis&&(i=setTimeout(()=>{this.log("ending client due to timeout"),s=!0,t.connection?t.connection.stream.destroy():t.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),t.connect(a=>{if(i&&clearTimeout(i),t.on("error",n),a)this.log("client failed to connect",a),this._clients=this._clients.filter(l=>l!==t),s&&(a.message="Connection terminated due to connection timeout"),this._pulseQueue(),e.timedOut||e.callback(a,void 0,qs);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let l=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(t),this._idle.findIndex(f=>f.client===t)!==-1&&this._acquireClient(t,new nt((f,h,y)=>y()),n,!1)},this.options.maxLifetimeSeconds*1e3);l.unref(),t.once("end",()=>clearTimeout(l))}return this._acquireClient(t,e,n,!0)}})}_acquireClient(e,t,n,i){i&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),t.timedOut?i&&this.options.verify?this.options.verify(e,e.release):e.release():i&&this.options.verify?this.options.verify(e,s=>{if(s)return e.release(s),t.callback(s,void 0,qs);t.callback(void 0,e,e.release)}):t.callback(void 0,e,e.release)}_releaseOnce(e,t){let n=!1;return i=>{n&&Gu(),n=!0,this._release(e,t,i)}}_release(e,t,n){if(e.on("error",t),e._poolUseCount=(e._poolUseCount||0)+1,n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses){e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e),this._pulseQueue();return}if(this._expired.has(e)){this.log("remove expired client"),this._expired.delete(e),this._remove(e),this._pulseQueue();return}let s;this.options.idleTimeoutMillis&&(s=setTimeout(()=>{this.log("remove idle client"),this._remove(e)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&s.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new yn(e,t,s)),this._pulseQueue()}query(e,t,n){if(typeof e=="function"){let s=Xt(this.Promise,e);return setImmediate(function(){return s.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),s.result}typeof t=="function"&&(n=t,t=void 0);let i=Xt(this.Promise,n);return n=i.callback,this.connect((s,a)=>{if(s)return n(s);let l=!1,o=f=>{l||(l=!0,a.release(f),n(f))};a.once("error",o),this.log("dispatching query");try{a.query(e,t,(f,h)=>{if(this.log("query dispatched"),a.removeListener("error",o),!l)return l=!0,a.release(f),f?n(f):n(void 0,h)})}catch(f){return a.release(f),n(f)}}),i.result}end(e){if(this.log("ending"),this.ending){let n=new Error("Called end on pool more than once");return e?e(n):this.Promise.reject(n)}this.ending=!0;let t=Xt(this.Promise,e);return this._endCallback=t.callback,this._pulseQueue(),t.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,t)=>e+(this._expired.has(t)?1:0),0)}get totalCount(){return this._clients.length}};Ms.exports=vn});var ks=I((Rd,Ku)=>{Ku.exports={name:"pg",version:"8.8.0",description:"PostgreSQL client - pure javascript & libpq with the same API",keywords:["database","libpq","pg","postgre","postgres","postgresql","rdbms"],homepage:"https://github.com/brianc/node-postgres",repository:{type:"git",url:"git://github.com/brianc/node-postgres.git",directory:"packages/pg"},author:"Brian Carlson <brian.m.carlson@gmail.com>",main:"./lib",dependencies:{"buffer-writer":"2.0.0","packet-reader":"1.0.0","pg-connection-string":"^2.5.0","pg-pool":"^3.5.2","pg-protocol":"^1.5.0","pg-types":"^2.1.0",pgpass:"1.x"},devDependencies:{async:"2.6.4",bluebird:"3.5.2",co:"4.6.0","pg-copy-streams":"0.3.0"},peerDependencies:{"pg-native":">=3.0.1"},peerDependenciesMeta:{"pg-native":{optional:!0}},scripts:{test:"make test-all"},files:["lib","SPONSORS.md"],license:"MIT",engines:{node:">= 8.0.0"},gitHead:"c99fb2c127ddf8d712500db2c7b9a5491a178655"}});var Qs=I((Id,Us)=>{"use strict";d();var Bs=Le().EventEmitter,Yu=(mt(),z(pt)),gn=Qt(),it=Us.exports=function(r,e,t){Bs.call(this),r=gn.normalizeQueryConfig(r,e,t),this.text=r.text,this.values=r.values,this.name=r.name,this.callback=r.callback,this.state="new",this._arrayMode=r.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(n){n==="row"&&(this._emitRowEvents=!0)}.bind(this))};Yu.inherits(it,Bs);var Ju={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};it.prototype.handleError=function(r){var e=this.native.pq.resultErrorFields();if(e)for(var t in e){var n=Ju[t]||t;r[n]=e[t]}this.callback?this.callback(r):this.emit("error",r),this.state="error"};it.prototype.then=function(r,e){return this._getPromise().then(r,e)};it.prototype.catch=function(r){return this._getPromise().catch(r)};it.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(r,e){this._once("end",r),this._once("error",e)}.bind(this)),this._promise)};it.prototype.submit=function(r){this.state="running";var e=this;this.native=r.native,r.native.arrayMode=this._arrayMode;var t=function(s,a,l){if(r.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),s)return e.handleError(s);e._emitRowEvents&&(l.length>1?a.forEach((o,f)=>{o.forEach(h=>{e.emit("row",h,l[f])})}):a.forEach(function(o){e.emit("row",o,l)})),e.state="end",e.emit("end",l),e.callback&&e.callback(null,l)};if(process.domain&&(t=process.domain.bind(t)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var n=(this.values||[]).map(gn.prepareValue);if(r.namedQueries[this.name]){if(this.text&&r.namedQueries[this.name]!==this.text){let s=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return t(s)}return r.native.execute(this.name,n,t)}return r.native.prepare(this.name,this.text,n.length,function(s){return s?t(s):(r.namedQueries[e.name]=e.text,e.native.execute(e.name,n,t))})}else if(this.values){if(!Array.isArray(this.values)){let s=new Error("Query values must be an array");return t(s)}var i=this.values.map(gn.prepareValue);r.native.query(this.text,i,t)}else r.native.query(this.text,t)}});var Ws=I((Cd,js)=>{"use strict";d();var Xu=no("pg-native"),Zu=Mr(),Td=ks(),$s=Le().EventEmitter,ec=(mt(),z(pt)),tc=Qr(),Vs=Qs(),ae=js.exports=function(r){$s.call(this),r=r||{},this._Promise=r.Promise||global.Promise,this._types=new Zu(r.types),this.native=new Xu({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var e=this.connectionParameters=new tc(r);this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};ae.Query=Vs;ec.inherits(ae,$s);ae.prototype._errorAllQueries=function(r){let e=t=>{process.nextTick(()=>{t.native=this.native,t.handleError(r)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};ae.prototype._connect=function(r){var e=this;if(this._connecting){process.nextTick(()=>r(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(t,n){if(t)return r(t);e.native.connect(n,function(i){if(i)return e.native.end(),r(i);e._connected=!0,e.native.on("error",function(s){e._queryable=!1,e._errorAllQueries(s),e.emit("error",s)}),e.native.on("notification",function(s){e.emit("notification",{channel:s.relname,payload:s.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),r()})})};ae.prototype.connect=function(r){if(r){this._connect(r);return}return new this._Promise((e,t)=>{this._connect(n=>{n?t(n):e()})})};ae.prototype.query=function(r,e,t){var n,i,s,a,l;if(r==null)throw new TypeError("Client was passed a null or undefined query");if(typeof r.submit=="function")s=r.query_timeout||this.connectionParameters.query_timeout,i=n=r,typeof e=="function"&&(r.callback=e);else if(s=this.connectionParameters.query_timeout,n=new Vs(r,e,t),!n.callback){let o,f;i=new this._Promise((h,y)=>{o=h,f=y}),n.callback=(h,y)=>h?f(h):o(y)}return s&&(l=n.callback,a=setTimeout(()=>{var o=new Error("Query read timeout");process.nextTick(()=>{n.handleError(o,this.connection)}),l(o),n.callback=()=>{};var f=this._queryQueue.indexOf(n);f>-1&&this._queryQueue.splice(f,1),this._pulseQueryQueue()},s),n.callback=(o,f)=>{clearTimeout(a),l(o,f)}),this._queryable?this._ending?(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"))}),i):(this._queryQueue.push(n),this._pulseQueryQueue(),i):(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"))}),i)};ae.prototype.end=function(r){var e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,r));var t;return r||(t=new this._Promise(function(n,i){r=s=>s?i(s):n()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),r&&r()})}),t};ae.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};ae.prototype._pulseQueryQueue=function(r){if(!!this._connected&&!this._hasActiveQuery()){var e=this._queryQueue.shift();if(!e){r||this.emit("drain");return}this._activeQuery=e,e.submit(this);var t=this;e.once("_done",function(){t._pulseQueryQueue()})}};ae.prototype.cancel=function(r){this._activeQuery===r?this.native.cancel(function(){}):this._queryQueue.indexOf(r)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(r),1)};ae.prototype.ref=function(){};ae.prototype.unref=function(){};ae.prototype.setTypeParser=function(r,e,t){return this._types.setTypeParser(r,e,t)};ae.prototype.getTypeParser=function(r,e){return this._types.getTypeParser(r,e)}});var _n=I((Pd,Hs)=>{"use strict";d();Hs.exports=Ws()});var Zt=I((Od,Rt)=>{"use strict";d();var rc=Ns(),nc=xt(),ic=pn(),sc=Fs(),{DatabaseError:ac}=dn(),oc=r=>class extends sc{constructor(t){super(t,r)}},En=function(r){this.defaults=nc,this.Client=r,this.Query=this.Client.Query,this.Pool=oc(this.Client),this._pools=[],this.Connection=ic,this.types=bt(),this.DatabaseError=ac};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?Rt.exports=new En(_n()):(Rt.exports=new En(rc),Object.defineProperty(Rt.exports,"native",{configurable:!0,enumerable:!1,get(){var r=null;try{r=new En(_n())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(Rt.exports,"native",{value:r}),r}}))});var zs=I(Gs=>{"use strict";d();Object.defineProperty(Gs,"__esModule",{value:!0})});var er=I(st=>{"use strict";d();Object.defineProperty(st,"__esModule",{value:!0});st.setConfig=st.getConfig=void 0;var wn={transactionAttemptsMax:5,transactionRetryDelay:{minMs:25,maxMs:250},castArrayParamsToJson:!1,castObjectParamsToJson:!1},lc=()=>({...wn});st.getConfig=lc;var uc=r=>wn={...wn,...r};st.setConfig=uc});var Ks={};fe(Ks,{performance:()=>cc});var cc,Ys=re(()=>{d();cc={now:Date.now}});var at=I(pe=>{"use strict";d();Object.defineProperty(pe,"__esModule",{value:!0});pe.isPOJO=pe.completeKeysWithDefaultValue=pe.mapWithSeparator=pe.wait=pe.pad=void 0;var fc=(r,e=2)=>{let t=String(r);return"000".slice(t.length+3-e)+t};pe.pad=fc;var dc=r=>new Promise(e=>setTimeout(e,r));pe.wait=dc;var hc=(r,e,t)=>{let n=[];for(let i=0,s=r.length;i<s;i++)i>0&&n.push(e),n.push(t(r[i],i,r));return n};pe.mapWithSeparator=hc;var pc=(r,e)=>{let t=Object.assign({},...r);for(let n in t)t[n]=e;return r.map(n=>({...t,...n}))};pe.completeKeysWithDefaultValue=pc;var mc=r=>typeof r=="object"&&r!==null&&r.constructor===Object&&r.toString()==="[object Object]";pe.isPOJO=mc});var Pt=I(O=>{"use strict";d();Object.defineProperty(O,"__esModule",{value:!0});O.SQLFragment=O.sql=O.parent=O.ParentColumn=O.vals=O.ColumnValues=O.cols=O.ColumnNames=O.raw=O.DangerousRawString=O.param=O.Parameter=O.toBuffer=O.strict=O.all=O.self=O.Default=void 0;var Js=(Ys(),z(Ks)),Xs=er(),yc=at();O.Default=Symbol("DEFAULT");O.self=Symbol("self");O.all=Symbol("all");function Zs(r){return function(e){return e===null?null:r(e)}}O.strict=Zs;O.toBuffer=Zs(r=>Buffer.from(r.slice(2),"hex"));var Te=class{constructor(e,t){this.value=e,this.cast=t}};O.Parameter=Te;function vc(r,e){return new Te(r,e)}O.param=vc;var It=class{constructor(e){this.value=e}};O.DangerousRawString=It;function gc(r){return new It(r)}O.raw=gc;var Tt=class{constructor(e){this.value=e}};O.ColumnNames=Tt;function _c(r){return new Tt(r)}O.cols=_c;var Ct=class{constructor(e){this.value=e}};O.ColumnValues=Ct;function Ec(r){return new Ct(r)}O.vals=Ec;var ot=class{constructor(e){this.value=e}};O.ParentColumn=ot;function wc(r){return new ot(r)}O.parent=wc;function Sc(r,...e){return new Ce(Array.prototype.slice.apply(r),e)}O.sql=Sc;var bc=0,Ce=class{constructor(e,t){this.literals=e,this.expressions=t,this.runResultTransform=n=>n.rows,this.parentTable=void 0,this.preparedName=void 0,this.noop=!1,this.prepared=(n=`_zapatos_prepared_${bc++}`)=>(this.preparedName=n,this),this.run=async(n,i=!1)=>{var s;let a=this.compile(),l=(0,Xs.getConfig)(),o=(s=n._zapatos)===null||s===void 0?void 0:s.txnId;l.queryListener&&l.queryListener(a,o);let f=Js.performance.now(),h;if(!this.noop||i){let y=await n.query(a);h=this.runResultTransform(y)}else h=this.noopResult;return l.resultListener&&l.resultListener(h,o,Js.performance.now()-f),h},this.compile=(n={text:"",values:[]},i,s)=>{this.parentTable&&(i=this.parentTable),this.noop&&(n.text+="/* marked no-op: won't hit DB unless forced -> */ "),n.text+=this.literals[0];for(let a=1,l=this.literals.length;a<l;a++)this.compileExpression(this.expressions[a-1],n,i,s),n.text+=this.literals[a];return this.preparedName!=null&&(n.name=this.preparedName),n},this.compileExpression=(n,i={text:"",values:[]},s,a)=>{var l;if(this.parentTable&&(s=this.parentTable),n instanceof Ce)n.compile(i,s,a);else if(typeof n=="string")i.text+=n.startsWith('"')&&n.endsWith('"')?n:`"${n.replace(/[.]/g,'"."')}"`;else if(n instanceof It)i.text+=n.value;else if(Array.isArray(n))for(let o=0,f=n.length;o<f;o++)this.compileExpression(n[o],i,s,a);else if(n instanceof Te){let o="$"+String(i.values.length+1),f=(0,Xs.getConfig)();n.cast!==!1&&(n.cast===!0||f.castArrayParamsToJson)&&Array.isArray(n.value)||n.cast!==!1&&(n.cast===!0||f.castObjectParamsToJson)&&(0,yc.isPOJO)(n.value)?(i.values.push(JSON.stringify(n.value)),i.text+=`CAST(${o} AS "json")`):typeof n.cast=="string"?(i.values.push(n.value),i.text+=`CAST(${o} AS "${n.cast}")`):(i.values.push(n.value),i.text+=o)}else if(n===O.Default)i.text+="DEFAULT";else if(n===O.self){if(!a)throw new Error("The 'self' column alias has no meaning here");this.compileExpression(a,i)}else if(n instanceof ot){if(!s)throw new Error("The 'parent' table alias has no meaning here");this.compileExpression(s,i),i.text+=".",this.compileExpression((l=n.value)!==null&&l!==void 0?l:a,i)}else if(n instanceof Tt){let o=Array.isArray(n.value)?n.value:Object.keys(n.value).sort();for(let f=0,h=o.length;f<h;f++)f>0&&(i.text+=", "),this.compileExpression(String(o[f]),i)}else if(n instanceof Ct)if(Array.isArray(n.value)){let o=n.value;for(let f=0,h=o.length;f<h;f++){let y=o[f];f>0&&(i.text+=", "),y instanceof Ce?this.compileExpression(y,i,s):this.compileExpression(new Te(y),i,s)}}else{let o=Object.keys(n.value).sort(),f=o.map(h=>n.value[h]);for(let h=0,y=f.length;h<y;h++){let E=o[h],D=f[h];h>0&&(i.text+=", "),D instanceof Ce||D instanceof Te||D===O.Default?this.compileExpression(D,i,s,E):this.compileExpression(new Te(D),i,s,E)}}else if(typeof n=="object"){let o=Object.keys(n).sort();if(o.length){i.text+="(";for(let f=0,h=o.length;f<h;f++){let y=o[f],E=n[y];f>0&&(i.text+=" AND "),E instanceof Ce?(i.text+="(",this.compileExpression(E,i,s,y),i.text+=")"):(this.compileExpression(y,i),i.text+=" = ",this.compileExpression(E instanceof ot?E:new Te(E),i,s,y))}i.text+=")"}else i.text+="TRUE"}else throw new Error(`Alien object while interpolating SQL: ${n}`)}}};O.SQLFragment=Ce});var ea=I(lt=>{"use strict";d();Object.defineProperty(lt,"__esModule",{value:!0});lt.toString=lt.toDate=void 0;var Qe=at(),xc=function(r,e){let t;if(r===null)return null;switch(e){case void 0:return new Date(r);case"UTC":return new Date(r+"Z");case"local":if(t=r.match(/^([0-9]+)-([0-9]+)-([0-9]+)$/)){let[,n,i,s]=t;return new Date(parseInt(n,10),parseInt(i,10)-1,parseInt(s,10))}return new Date(r)}};lt.toDate=xc;var Ac=function(r,e){if(r===null)return null;if(e==="timestamptz")return r.toISOString();let[t,n]=e.split(":"),i=n==="UTC",s=(0,Qe.pad)(i?r.getUTCFullYear():r.getFullYear(),4),a=(0,Qe.pad)((i?r.getUTCMonth():r.getMonth())+1),l=(0,Qe.pad)(i?r.getUTCDate():r.getDate());if(t==="date")return`${s}-${a}-${l}`;let o=(0,Qe.pad)(i?r.getUTCHours():r.getHours()),f=(0,Qe.pad)(i?r.getUTCMinutes():r.getMinutes()),h=(0,Qe.pad)(i?r.getUTCSeconds():r.getSeconds()),y=(0,Qe.pad)(i?r.getUTCMilliseconds():r.getMilliseconds(),3);return`${s}-${a}-${l}T${o}:${f}:${h}.${y}`};lt.toString=Ac});var Sn=I(tr=>{"use strict";d();Object.defineProperty(tr,"__esModule",{value:!0});tr.isDatabaseError=void 0;function Rc(r,...e){let{code:t}=r;return!t||t.length!==5?!1:e.some(n=>t.startsWith(Ic[n]))}tr.isDatabaseError=Rc;var Ic={SuccessfulCompletion:"00",Warning:"01",NoData:"02",SqlStatementNotYetComplete:"03",ConnectionException:"08",TriggeredActionException:"09",FeatureNotSupported:"0A",InvalidTransactionInitiation:"0B",LocatorException:"0F",InvalidGrantor:"0L",InvalidRoleSpecification:"0P",DiagnosticsException:"0Z",CaseNotFound:"20",CardinalityViolation:"21",DataException:"22",IntegrityConstraintViolation:"23",InvalidCursorState:"24",InvalidTransactionState:"25",InvalidSqlStatementName:"26",TriggeredDataChangeViolation:"27",InvalidAuthorizationSpecification:"28",DependentPrivilegeDescriptorsStillExist:"2B",InvalidTransactionTermination:"2D",SqlRoutineException:"2F",InvalidCursorName:"34",ExternalRoutineException:"38",ExternalRoutineInvocationException:"39",SavepointException:"3B",InvalidCatalogName:"3D",InvalidSchemaName:"3F",TransactionRollback:"40",SyntaxErrorOrAccessRuleViolation:"42",WithCheckOptionViolation:"44",InsufficientResources:"53",DiskFull:"53",OutOfMemory:"53",TooManyConnections:"53",ConfigurationLimitExceeded:"53",ProgramLimitExceeded:"54",ObjectNotInPrerequisiteState:"55",OperatorIntervention:"57",SystemError:"58",SnapshotTooOld:"72",ConfigFileError:"F0",FdwError:"HV",PlpgsqlError:"P0",InternalError:"XX",SuccessfulCompletion_SuccessfulCompletion:"00000",Warning_Warning:"01000",Warning_NullValueEliminatedInSetFunction:"01003",Warning_StringDataRightTruncation:"01004",Warning_PrivilegeNotRevoked:"01006",Warning_PrivilegeNotGranted:"01007",Warning_ImplicitZeroBitPadding:"01008",Warning_DynamicResultSetsReturned:"0100C",Warning_DeprecatedFeature:"01P01",NoData_NoData:"02000",NoData_NoAdditionalDynamicResultSetsReturned:"02001",SqlStatementNotYetComplete_SqlStatementNotYetComplete:"03000",ConnectionException_ConnectionException:"08000",ConnectionException_SqlclientUnableToEstablishSqlconnection:"08001",ConnectionException_ConnectionDoesNotExist:"08003",ConnectionException_SqlserverRejectedEstablishmentOfSqlconnection:"08004",ConnectionException_ConnectionFailure:"08006",ConnectionException_TransactionResolutionUnknown:"08007",ConnectionException_ProtocolViolation:"08P01",TriggeredActionException_TriggeredActionException:"09000",FeatureNotSupported_FeatureNotSupported:"0A000",InvalidTransactionInitiation_InvalidTransactionInitiation:"0B000",LocatorException_LocatorException:"0F000",LocatorException_InvalidLocatorSpecification:"0F001",InvalidGrantor_InvalidGrantor:"0L000",InvalidGrantor_InvalidGrantOperation:"0LP01",InvalidRoleSpecification_InvalidRoleSpecification:"0P000",DiagnosticsException_DiagnosticsException:"0Z000",DiagnosticsException_StackedDiagnosticsAccessedWithoutActiveHandler:"0Z002",CaseNotFound_CaseNotFound:"20000",CardinalityViolation_CardinalityViolation:"21000",DataException_DataException:"22000",DataException_StringDataRightTruncation:"22001",DataException_NullValueNoIndicatorParameter:"22002",DataException_NumericValueOutOfRange:"22003",DataException_NullValueNotAllowed:"22004",DataException_ErrorInAssignment:"22005",DataException_InvalidDatetimeFormat:"22007",DataException_DatetimeFieldOverflow:"22008",DataException_InvalidTimeZoneDisplacementValue:"22009",DataException_EscapeCharacterConflict:"2200B",DataException_InvalidUseOfEscapeCharacter:"2200C",DataException_InvalidEscapeOctet:"2200D",DataException_ZeroLengthCharacterString:"2200F",DataException_MostSpecificTypeMismatch:"2200G",DataException_SequenceGeneratorLimitExceeded:"2200H",DataException_NotAnXmlDocument:"2200L",DataException_InvalidXmlDocument:"2200M",DataException_InvalidXmlContent:"2200N",DataException_InvalidXmlComment:"2200S",DataException_InvalidXmlProcessingInstruction:"2200T",DataException_InvalidIndicatorParameterValue:"22010",DataException_SubstringError:"22011",DataException_DivisionByZero:"22012",DataException_InvalidPrecedingOrFollowingSize:"22013",DataException_InvalidArgumentForNtileFunction:"22014",DataException_IntervalFieldOverflow:"22015",DataException_InvalidArgumentForNthValueFunction:"22016",DataException_InvalidCharacterValueForCast:"22018",DataException_InvalidEscapeCharacter:"22019",DataException_InvalidRegularExpression:"2201B",DataException_InvalidArgumentForLogarithm:"2201E",DataException_InvalidArgumentForPowerFunction:"2201F",DataException_InvalidArgumentForWidthBucketFunction:"2201G",DataException_InvalidRowCountInLimitClause:"2201W",DataException_InvalidRowCountInResultOffsetClause:"2201X",DataException_CharacterNotInRepertoire:"22021",DataException_IndicatorOverflow:"22022",DataException_InvalidParameterValue:"22023",DataException_UnterminatedCString:"22024",DataException_InvalidEscapeSequence:"22025",DataException_StringDataLengthMismatch:"22026",DataException_TrimError:"22027",DataException_ArraySubscriptError:"2202E",DataException_InvalidTablesampleRepeat:"2202G",DataException_InvalidTablesampleArgument:"2202H",DataException_FloatingPointException:"22P01",DataException_InvalidTextRepresentation:"22P02",DataException_InvalidBinaryRepresentation:"22P03",DataException_BadCopyFileFormat:"22P04",DataException_UntranslatableCharacter:"22P05",DataException_NonstandardUseOfEscapeCharacter:"22P06",IntegrityConstraintViolation_IntegrityConstraintViolation:"23000",IntegrityConstraintViolation_RestrictViolation:"23001",IntegrityConstraintViolation_NotNullViolation:"23502",IntegrityConstraintViolation_ForeignKeyViolation:"23503",IntegrityConstraintViolation_UniqueViolation:"23505",IntegrityConstraintViolation_CheckViolation:"23514",IntegrityConstraintViolation_ExclusionViolation:"23P01",InvalidCursorState_InvalidCursorState:"24000",InvalidTransactionState_InvalidTransactionState:"25000",InvalidTransactionState_ActiveSqlTransaction:"25001",InvalidTransactionState_BranchTransactionAlreadyActive:"25002",InvalidTransactionState_InappropriateAccessModeForBranchTransaction:"25003",InvalidTransactionState_InappropriateIsolationLevelForBranchTransaction:"25004",InvalidTransactionState_NoActiveSqlTransactionForBranchTransaction:"25005",InvalidTransactionState_ReadOnlySqlTransaction:"25006",InvalidTransactionState_SchemaAndDataStatementMixingNotSupported:"25007",InvalidTransactionState_HeldCursorRequiresSameIsolationLevel:"25008",InvalidTransactionState_NoActiveSqlTransaction:"25P01",InvalidTransactionState_InFailedSqlTransaction:"25P02",InvalidTransactionState_IdleInTransactionSessionTimeout:"25P03",InvalidSqlStatementName_InvalidSqlStatementName:"26000",TriggeredDataChangeViolation_TriggeredDataChangeViolation:"27000",InvalidAuthorizationSpecification_InvalidAuthorizationSpecification:"28000",InvalidAuthorizationSpecification_InvalidPassword:"28P01",DependentPrivilegeDescriptorsStillExist_DependentPrivilegeDescriptorsStillExist:"2B000",DependentPrivilegeDescriptorsStillExist_DependentObjectsStillExist:"2BP01",InvalidTransactionTermination_InvalidTransactionTermination:"2D000",SqlRoutineException_SqlRoutineException:"2F000",SqlRoutineException_ModifyingSqlDataNotPermitted:"2F002",SqlRoutineException_ProhibitedSqlStatementAttempted:"2F003",SqlRoutineException_ReadingSqlDataNotPermitted:"2F004",SqlRoutineException_FunctionExecutedNoReturnStatement:"2F005",InvalidCursorName_InvalidCursorName:"34000",ExternalRoutineException_ExternalRoutineException:"38000",ExternalRoutineException_ContainingSqlNotPermitted:"38001",ExternalRoutineException_ModifyingSqlDataNotPermitted:"38002",ExternalRoutineException_ProhibitedSqlStatementAttempted:"38003",ExternalRoutineException_ReadingSqlDataNotPermitted:"38004",ExternalRoutineInvocationException_ExternalRoutineInvocationException:"39000",ExternalRoutineInvocationException_InvalidSqlstateReturned:"39001",ExternalRoutineInvocationException_NullValueNotAllowed:"39004",ExternalRoutineInvocationException_TriggerProtocolViolated:"39P01",ExternalRoutineInvocationException_SrfProtocolViolated:"39P02",ExternalRoutineInvocationException_EventTriggerProtocolViolated:"39P03",SavepointException_SavepointException:"3B000",SavepointException_InvalidSavepointSpecification:"3B001",InvalidCatalogName_InvalidCatalogName:"3D000",InvalidSchemaName_InvalidSchemaName:"3F000",TransactionRollback_TransactionRollback:"40000",TransactionRollback_SerializationFailure:"40001",TransactionRollback_TransactionIntegrityConstraintViolation:"40002",TransactionRollback_StatementCompletionUnknown:"40003",TransactionRollback_DeadlockDetected:"40P01",SyntaxErrorOrAccessRuleViolation_SyntaxErrorOrAccessRuleViolation:"42000",SyntaxErrorOrAccessRuleViolation_InsufficientPrivilege:"42501",SyntaxErrorOrAccessRuleViolation_SyntaxError:"42601",SyntaxErrorOrAccessRuleViolation_InvalidName:"42602",SyntaxErrorOrAccessRuleViolation_InvalidColumnDefinition:"42611",SyntaxErrorOrAccessRuleViolation_NameTooLong:"42622",SyntaxErrorOrAccessRuleViolation_DuplicateColumn:"42701",SyntaxErrorOrAccessRuleViolation_AmbiguousColumn:"42702",SyntaxErrorOrAccessRuleViolation_UndefinedColumn:"42703",SyntaxErrorOrAccessRuleViolation_UndefinedObject:"42704",SyntaxErrorOrAccessRuleViolation_DuplicateObject:"42710",SyntaxErrorOrAccessRuleViolation_DuplicateAlias:"42712",SyntaxErrorOrAccessRuleViolation_DuplicateFunction:"42723",SyntaxErrorOrAccessRuleViolation_AmbiguousFunction:"42725",SyntaxErrorOrAccessRuleViolation_GroupingError:"42803",SyntaxErrorOrAccessRuleViolation_DatatypeMismatch:"42804",SyntaxErrorOrAccessRuleViolation_WrongObjectType:"42809",SyntaxErrorOrAccessRuleViolation_InvalidForeignKey:"42830",SyntaxErrorOrAccessRuleViolation_CannotCoerce:"42846",SyntaxErrorOrAccessRuleViolation_UndefinedFunction:"42883",SyntaxErrorOrAccessRuleViolation_GeneratedAlways:"428C9",SyntaxErrorOrAccessRuleViolation_ReservedName:"42939",SyntaxErrorOrAccessRuleViolation_UndefinedTable:"42P01",SyntaxErrorOrAccessRuleViolation_UndefinedParameter:"42P02",SyntaxErrorOrAccessRuleViolation_DuplicateCursor:"42P03",SyntaxErrorOrAccessRuleViolation_DuplicateDatabase:"42P04",SyntaxErrorOrAccessRuleViolation_DuplicatePreparedStatement:"42P05",SyntaxErrorOrAccessRuleViolation_DuplicateSchema:"42P06",SyntaxErrorOrAccessRuleViolation_DuplicateTable:"42P07",SyntaxErrorOrAccessRuleViolation_AmbiguousParameter:"42P08",SyntaxErrorOrAccessRuleViolation_AmbiguousAlias:"42P09",SyntaxErrorOrAccessRuleViolation_InvalidColumnReference:"42P10",SyntaxErrorOrAccessRuleViolation_InvalidCursorDefinition:"42P11",SyntaxErrorOrAccessRuleViolation_InvalidDatabaseDefinition:"42P12",SyntaxErrorOrAccessRuleViolation_InvalidFunctionDefinition:"42P13",SyntaxErrorOrAccessRuleViolation_InvalidPreparedStatementDefinition:"42P14",SyntaxErrorOrAccessRuleViolation_InvalidSchemaDefinition:"42P15",SyntaxErrorOrAccessRuleViolation_InvalidTableDefinition:"42P16",SyntaxErrorOrAccessRuleViolation_InvalidObjectDefinition:"42P17",SyntaxErrorOrAccessRuleViolation_IndeterminateDatatype:"42P18",SyntaxErrorOrAccessRuleViolation_InvalidRecursion:"42P19",SyntaxErrorOrAccessRuleViolation_WindowingError:"42P20",SyntaxErrorOrAccessRuleViolation_CollationMismatch:"42P21",SyntaxErrorOrAccessRuleViolation_IndeterminateCollation:"42P22",WithCheckOptionViolation_WithCheckOptionViolation:"44000",InsufficientResources_InsufficientResources:"53000",InsufficientResources_DiskFull:"53100",InsufficientResources_OutOfMemory:"53200",InsufficientResources_TooManyConnections:"53300",InsufficientResources_ConfigurationLimitExceeded:"53400",ProgramLimitExceeded_ProgramLimitExceeded:"54000",ProgramLimitExceeded_StatementTooComplex:"54001",ProgramLimitExceeded_TooManyColumns:"54011",ProgramLimitExceeded_TooManyArguments:"54023",ObjectNotInPrerequisiteState_ObjectNotInPrerequisiteState:"55000",ObjectNotInPrerequisiteState_ObjectInUse:"55006",ObjectNotInPrerequisiteState_CantChangeRuntimeParam:"55P02",ObjectNotInPrerequisiteState_LockNotAvailable:"55P03",OperatorIntervention_OperatorIntervention:"57000",OperatorIntervention_QueryCanceled:"57014",OperatorIntervention_AdminShutdown:"57P01",OperatorIntervention_CrashShutdown:"57P02",OperatorIntervention_CannotConnectNow:"57P03",OperatorIntervention_DatabaseDropped:"57P04",SystemError_SystemError:"58000",SystemError_IoError:"58030",SystemError_UndefinedFile:"58P01",SystemError_DuplicateFile:"58P02",SnapshotTooOld_SnapshotTooOld:"72000",ConfigFileError_ConfigFileError:"F0000",ConfigFileError_LockFileExists:"F0001",FdwError_FdwError:"HV000",FdwError_FdwOutOfMemory:"HV001",FdwError_FdwDynamicParameterValueNeeded:"HV002",FdwError_FdwInvalidDataType:"HV004",FdwError_FdwColumnNameNotFound:"HV005",FdwError_FdwInvalidDataTypeDescriptors:"HV006",FdwError_FdwInvalidColumnName:"HV007",FdwError_FdwInvalidColumnNumber:"HV008",FdwError_FdwInvalidUseOfNullPointer:"HV009",FdwError_FdwInvalidStringFormat:"HV00A",FdwError_FdwInvalidHandle:"HV00B",FdwError_FdwInvalidOptionIndex:"HV00C",FdwError_FdwInvalidOptionName:"HV00D",FdwError_FdwOptionNameNotFound:"HV00J",FdwError_FdwReplyHandle:"HV00K",FdwError_FdwUnableToCreateExecution:"HV00L",FdwError_FdwUnableToCreateReply:"HV00M",FdwError_FdwUnableToEstablishConnection:"HV00N",FdwError_FdwNoSchemas:"HV00P",FdwError_FdwSchemaNotFound:"HV00Q",FdwError_FdwTableNotFound:"HV00R",FdwError_FdwFunctionSequenceError:"HV010",FdwError_FdwTooManyHandles:"HV014",FdwError_FdwInconsistentDescriptorInformation:"HV021",FdwError_FdwInvalidAttributeValue:"HV024",FdwError_FdwInvalidStringLengthOrBufferLength:"HV090",FdwError_FdwInvalidDescriptorFieldIdentifier:"HV091",PlpgsqlError_PlpgsqlError:"P0000",PlpgsqlError_RaiseException:"P0001",PlpgsqlError_NoDataFound:"P0002",PlpgsqlError_TooManyRows:"P0003",PlpgsqlError_AssertFailure:"P0004",InternalError_InternalError:"XX000",InternalError_DataCorrupted:"XX001",InternalError_IndexCorrupted:"XX002"}});var ta=I(T=>{"use strict";d();Object.defineProperty(T,"__esModule",{value:!0});T.max=T.min=T.avg=T.sum=T.count=T.selectExactlyOne=T.selectOne=T.select=T.NotExactlyOneError=T.SelectResultMode=T.truncate=T.deletes=T.update=T.upsert=T.doNothing=T.constraint=T.Constraint=T.insert=void 0;var m=Pt(),le=at();function Dt(r,e){return r===void 0?(0,m.sql)`to_jsonb(${e}.*)`:(0,m.sql)`jsonb_build_object(${(0,le.mapWithSeparator)(r,(0,m.sql)`, `,t=>(0,m.sql)`${(0,m.param)(t)}::text, ${t}`)})`}function Ot(r){return r===void 0?[]:(0,m.sql)` || jsonb_build_object(${(0,le.mapWithSeparator)(Object.keys(r),(0,m.sql)`, `,e=>(0,m.sql)`${(0,m.param)(e)}::text, ${r[e]}`)})`}var Tc=function(r,e,t){let n;if(Array.isArray(e)&&e.length===0)n=(0,m.sql)`INSERT INTO ${r} SELECT null WHERE false`,n.noop=!0,n.noopResult=[];else{let i=Array.isArray(e)?(0,le.completeKeysWithDefaultValue)(e,m.Default):e,s=(0,m.cols)(Array.isArray(i)?i[0]:i),a=Array.isArray(i)?(0,le.mapWithSeparator)(i,(0,m.sql)`, `,f=>(0,m.sql)`(${(0,m.vals)(f)})`):(0,m.sql)`(${(0,m.vals)(i)})`,l=Dt(t?.returning,r),o=Ot(t?.extras);n=(0,m.sql)`INSERT INTO ${r} (${s}) VALUES ${a} RETURNING ${l}${o} AS result`}return n.runResultTransform=Array.isArray(e)?i=>i.rows.map(s=>s.result):i=>i.rows[0].result,n};T.insert=Tc;var rr=class{constructor(e){this.value=e}};T.Constraint=rr;function Cc(r){return new rr(r)}T.constraint=Cc;T.doNothing=[];var Pc=function(r,e,t,n){var i,s,a;if(Array.isArray(e)&&e.length===0)return(0,T.insert)(r,e);typeof t=="string"&&(t=[t]);let l=(i=n?.noNullUpdateColumns)!==null&&i!==void 0?i:[];Array.isArray(l)||(l=[l]);let o=n?.updateColumns;o&&!Array.isArray(o)&&(o=[o]);let f=Array.isArray(e)?(0,le.completeKeysWithDefaultValue)(e,m.Default):[e],h=f[0],y=(0,m.cols)(h),E=(0,le.mapWithSeparator)(f,(0,m.sql)`, `,U=>(0,m.sql)`(${(0,m.vals)(U)})`),D=Object.keys(h),k=(s=n?.updateValues)!==null&&s!==void 0?s:{},K=[...new Set([...(a=o)!==null&&a!==void 0?a:D,...Object.keys(k)])],_e=Array.isArray(t)?(0,m.sql)`(${(0,le.mapWithSeparator)(t,(0,m.sql)`, `,U=>U)})`:(0,m.sql)`ON CONSTRAINT ${t.value}`,Ae=(0,le.mapWithSeparator)(K,(0,m.sql)`, `,U=>U),N=(0,le.mapWithSeparator)(K,(0,m.sql)`, `,U=>k[U]!==void 0?k[U]:l.includes(U)?(0,m.sql)`CASE WHEN EXCLUDED.${U} IS NULL THEN ${r}.${U} ELSE EXCLUDED.${U} END`:(0,m.sql)`EXCLUDED.${U}`),S=Dt(n?.returning,r),Ee=Ot(n?.extras),ue=n?.reportAction==="suppress",H=(0,m.sql)`INSERT INTO ${r} (${y}) VALUES ${E}`,me=(0,m.sql)`ON CONFLICT ${_e} DO`,we=Ae.length>0?(0,m.sql)`UPDATE SET (${Ae}) = ROW(${N})`:(0,m.sql)`NOTHING`,Se=(0,m.sql)` || jsonb_build_object('$action', CASE xmax WHEN 0 THEN 'INSERT' ELSE 'UPDATE' END)`,B=(0,m.sql)`RETURNING ${S}${Ee}${ue?[]:Se} AS result`,X=(0,m.sql)`${H} ${me} ${we} ${B}`;return X.runResultTransform=Array.isArray(e)?U=>U.rows.map(ce=>ce.result):U=>{var ce;return(ce=U.rows[0])===null||ce===void 0?void 0:ce.result},X};T.upsert=Pc;var Dc=function(r,e,t,n){let i=Dt(n?.returning,r),s=Ot(n?.extras),a=(0,m.sql)`UPDATE ${r} SET (${(0,m.cols)(e)}) = ROW(${(0,m.vals)(e)}) WHERE ${t} RETURNING ${i}${s} AS result`;return a.runResultTransform=l=>l.rows.map(o=>o.result),a};T.update=Dc;var Oc=function(r,e,t){let n=Dt(t?.returning,r),i=Ot(t?.extras),s=(0,m.sql)`DELETE FROM ${r} WHERE ${e} RETURNING ${n}${i} AS result`;return s.runResultTransform=a=>a.rows.map(l=>l.result),s};T.deletes=Oc;var Nc=function(r,...e){Array.isArray(r)||(r=[r]);let t=(0,le.mapWithSeparator)(r,(0,m.sql)`, `,i=>i);return(0,m.sql)`TRUNCATE ${t}${(0,m.raw)((e.length?" ":"")+e.join(" "))}`};T.truncate=Nc;var ee;(function(r){r[r.Many=0]="Many",r[r.One=1]="One",r[r.ExactlyOne=2]="ExactlyOne",r[r.Numeric=3]="Numeric"})(ee=T.SelectResultMode||(T.SelectResultMode={}));var ut=class extends Error{constructor(e,...t){super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,ut),this.name="NotExactlyOneError",this.query=e}};T.NotExactlyOneError=ut;var qc=function(r,e=m.all,t={},n=ee.Many,i="count"){let s=n===ee.One||n===ee.ExactlyOne,a=s?{...t,limit:1}:t,l=a.alias||r,{distinct:o,groupBy:f,having:h,lateral:y,columns:E,extras:D}=a,k=a.lock===void 0||Array.isArray(a.lock)?a.lock:[a.lock],K=a.order===void 0||Array.isArray(a.order)?a.order:[a.order],_e=l===r?[]:(0,m.sql)` AS ${l}`,Ae=o?(0,m.sql)` DISTINCT${o instanceof m.SQLFragment||typeof o=="string"?(0,m.sql)` ON (${o})`:Array.isArray(o)?(0,m.sql)` ON (${(0,m.cols)(o)})`:[]}`:[],N=y instanceof m.SQLFragment?[]:n===ee.Numeric?E?(0,m.sql)`${(0,m.raw)(i)}(${(0,m.cols)(E)})`:(0,m.sql)`${(0,m.raw)(i)}(${l}.*)`:Dt(E,l),S=y instanceof m.SQLFragment||n===ee.Numeric?[]:Ot(D),Ee=y===void 0||n===ee.Numeric?[]:y instanceof m.SQLFragment?(0,m.sql)`"lateral_passthru".result`:(0,m.sql)` || jsonb_build_object(${(0,le.mapWithSeparator)(Object.keys(y).sort(),(0,m.sql)`, `,q=>(0,m.sql)`${(0,m.param)(q)}::text, "lateral_${(0,m.raw)(q)}".result`)})`,ue=(0,m.sql)`${N}${S}${Ee}`,H=e===m.all?[]:(0,m.sql)` WHERE ${e}`,me=f?(0,m.sql)` GROUP BY ${f instanceof m.SQLFragment||typeof f=="string"?f:(0,m.cols)(f)}`:[],we=h?(0,m.sql)` HAVING ${h}`:[],Se=K===void 0?[]:(0,m.sql)` ORDER BY ${(0,le.mapWithSeparator)(K,(0,m.sql)`, `,q=>{if(!["ASC","DESC"].includes(q.direction))throw new Error(`Direction must be ASC/DESC, not '${q.direction}'`);if(q.nulls&&!["FIRST","LAST"].includes(q.nulls))throw new Error(`Nulls must be FIRST/LAST/undefined, not '${q.nulls}'`);return(0,m.sql)`${q.by} ${(0,m.raw)(q.direction)}${q.nulls?(0,m.sql)` NULLS ${(0,m.raw)(q.nulls)}`:[]}`})}`,B=a.limit===void 0?[]:a.withTies?(0,m.sql)` FETCH FIRST ${(0,m.param)(a.limit)} ROWS WITH TIES`:(0,m.sql)` LIMIT ${(0,m.param)(a.limit)}`,X=a.offset===void 0?[]:(0,m.sql)` OFFSET ${(0,m.param)(a.offset)}`,U=k===void 0?[]:k.map(q=>{let G=q.of===void 0||Array.isArray(q.of)?q.of:[q.of],We=G===void 0?[]:(0,m.sql)` OF ${(0,le.mapWithSeparator)(G,(0,m.sql)`, `,ir=>ir)}`;return(0,m.sql)` FOR ${(0,m.raw)(q.for)}${We}${q.wait?(0,m.sql)` ${(0,m.raw)(q.wait)}`:[]}`}),ce=y===void 0?[]:y instanceof m.SQLFragment?(()=>(y.parentTable=l,(0,m.sql)` LEFT JOIN LATERAL (${y}) AS "lateral_passthru" ON true`))():Object.keys(y).sort().map(q=>{let G=y[q];return G.parentTable=l,(0,m.sql)` LEFT JOIN LATERAL (${G}) AS "lateral_${(0,m.raw)(q)}" ON true`}),je=(0,m.sql)`SELECT${Ae} ${ue} AS result FROM ${r}${_e}${ce}${H}${me}${we}${Se}${B}${X}${U}`,Pe=n!==ee.Many?je:(0,m.sql)`SELECT coalesce(jsonb_agg(result), '[]') AS result FROM (${je}) AS ${(0,m.raw)(`"sq_${l}"`)}`;return Pe.runResultTransform=n===ee.Numeric?q=>Number(q.rows[0].result):n===ee.ExactlyOne?q=>{var G;let We=(G=q.rows[0])===null||G===void 0?void 0:G.result;if(We===void 0)throw new ut(Pe,"One result expected but none returned (hint: check `.query.compile()` on this Error)");return We}:q=>{var G;return(G=q.rows[0])===null||G===void 0?void 0:G.result},Pe};T.select=qc;var Lc=function(r,e,t={}){return(0,T.select)(r,e,t,ee.One)};T.selectOne=Lc;var Mc=function(r,e,t={}){return(0,T.select)(r,e,t,ee.ExactlyOne)};T.selectExactlyOne=Mc;var Fc=function(r,e,t){return(0,T.select)(r,e,t,ee.Numeric)};T.count=Fc;var kc=function(r,e,t){return(0,T.select)(r,e,t,ee.Numeric,"sum")};T.sum=kc;var Bc=function(r,e,t){return(0,T.select)(r,e,t,ee.Numeric,"avg")};T.avg=Bc;var Uc=function(r,e,t){return(0,T.select)(r,e,t,ee.Numeric,"min")};T.min=Uc;var Qc=function(r,e,t){return(0,T.select)(r,e,t,ee.Numeric,"max")};T.max=Qc});var ra=I(j=>{"use strict";d();Object.defineProperty(j,"__esModule",{value:!0});j.serializableRODeferrable=j.readCommittedRO=j.repeatableReadRO=j.serializableRO=j.readCommitted=j.repeatableRead=j.serializable=j.transaction=j.IsolationLevel=void 0;var ct=Zt(),$c=Sn(),Vc=at(),nr=Pt(),jc=er(),ke;(function(r){r.Serializable="SERIALIZABLE",r.RepeatableRead="REPEATABLE READ",r.ReadCommitted="READ COMMITTED",r.SerializableRO="SERIALIZABLE, READ ONLY",r.RepeatableReadRO="REPEATABLE READ, READ ONLY",r.ReadCommittedRO="READ COMMITTED, READ ONLY",r.SerializableRODeferrable="SERIALIZABLE, READ ONLY, DEFERRABLE"})(ke=j.IsolationLevel||(j.IsolationLevel={}));function Wc(r){return r instanceof ct.Pool?"pool":r instanceof ct.Client?"client":ct.native!==null&&r instanceof ct.native.Pool?"pool":ct.native!==null&&r instanceof ct.native.Client?"client":r._connected===void 0?"pool":"client"}var bn=0;async function Be(r,e,t){if(Object.prototype.hasOwnProperty.call(r,"_zapatos"))return t(r);bn>=Number.MAX_SAFE_INTEGER-1&&(bn=0);let n=bn++,i=Wc(r)==="pool",s=i?await r.connect():r;s._zapatos={isolationLevel:e,txnId:n};let a=(0,jc.getConfig)(),{transactionListener:l}=a,o=a.transactionAttemptsMax,{minMs:f,maxMs:h}=a.transactionRetryDelay;try{for(let y=1;;y++)try{y>1&&l&&l(`Retrying transaction, attempt ${y} of ${o}`,n),await(0,nr.sql)`START TRANSACTION ISOLATION LEVEL ${(0,nr.raw)(e)}`.run(s);let E=await t(s);return await(0,nr.sql)`COMMIT`.run(s),E}catch(E){if(await(0,nr.sql)`ROLLBACK`.run(s),(0,$c.isDatabaseError)(E,"TransactionRollback_SerializationFailure","TransactionRollback_DeadlockDetected"))if(y<o){let D=Math.round(f+(h-f)*Math.random());l&&l(`Transaction rollback (code ${E.code}) on attempt ${y} of ${o}, retrying in ${D}ms`,n),await(0,Vc.wait)(D)}else throw l&&l(`Transaction rollback (code ${E.code}) on attempt ${y} of ${o}, giving up`,n),E;else throw E}}finally{delete s._zapatos,i&&s.release()}}j.transaction=Be;async function Hc(r,e){return Be(r,ke.Serializable,e)}j.serializable=Hc;async function Gc(r,e){return Be(r,ke.RepeatableRead,e)}j.repeatableRead=Gc;async function zc(r,e){return Be(r,ke.ReadCommitted,e)}j.readCommitted=zc;async function Kc(r,e){return Be(r,ke.SerializableRO,e)}j.serializableRO=Kc;async function Yc(r,e){return Be(r,ke.RepeatableReadRO,e)}j.repeatableReadRO=Yc;async function Jc(r,e){return Be(r,ke.ReadCommittedRO,e)}j.readCommittedRO=Jc;async function Xc(r,e){return Be(r,ke.SerializableRODeferrable,e)}j.serializableRODeferrable=Xc});var ia=I(v=>{"use strict";d();Object.defineProperty(v,"__esModule",{value:!0});v.subtract=v.add=v.now=v.before=v.after=v.fromNow=v.not=v.and=v.or=v.isNotIn=v.isIn=v.notReImatch=v.notReMatch=v.reImatch=v.reMatch=v.notSimilarTo=v.similarTo=v.notIlike=v.ilike=v.notLike=v.like=v.notBetweenSymmetric=v.notBetween=v.betweenSymmetric=v.between=v.lte=v.lt=v.gte=v.gt=v.ne=v.eq=v.isNotDistinctFrom=v.isDistinctFrom=v.isNotUnknown=v.isUnknown=v.isNotFalse=v.isFalse=v.isNotTrue=v.isTrue=v.isNotNull=v.isNull=void 0;var g=Pt(),na=at(),F=r=>r instanceof g.SQLFragment||r instanceof g.ParentColumn||r instanceof g.Parameter?r:(0,g.param)(r);v.isNull=(0,g.sql)`${g.self} IS NULL`;v.isNotNull=(0,g.sql)`${g.self} IS NOT NULL`;v.isTrue=(0,g.sql)`${g.self} IS TRUE`;v.isNotTrue=(0,g.sql)`${g.self} IS NOT TRUE`;v.isFalse=(0,g.sql)`${g.self} IS FALSE`;v.isNotFalse=(0,g.sql)`${g.self} IS NOT FALSE`;v.isUnknown=(0,g.sql)`${g.self} IS UNKNOWN`;v.isNotUnknown=(0,g.sql)`${g.self} IS NOT UNKNOWN`;var Zc=r=>(0,g.sql)`${g.self} IS DISTINCT FROM ${F(r)}`;v.isDistinctFrom=Zc;var ef=r=>(0,g.sql)`${g.self} IS NOT DISTINCT FROM ${F(r)}`;v.isNotDistinctFrom=ef;var tf=r=>(0,g.sql)`${g.self} = ${F(r)}`;v.eq=tf;var rf=r=>(0,g.sql)`${g.self} <> ${F(r)}`;v.ne=rf;var nf=r=>(0,g.sql)`${g.self} > ${F(r)}`;v.gt=nf;var sf=r=>(0,g.sql)`${g.self} >= ${F(r)}`;v.gte=sf;var af=r=>(0,g.sql)`${g.self} < ${F(r)}`;v.lt=af;var of=r=>(0,g.sql)`${g.self} <= ${F(r)}`;v.lte=of;var lf=(r,e)=>(0,g.sql)`${g.self} BETWEEN (${F(r)}) AND (${F(e)})`;v.between=lf;var uf=(r,e)=>(0,g.sql)`${g.self} BETWEEN SYMMETRIC (${F(r)}) AND (${F(e)})`;v.betweenSymmetric=uf;var cf=(r,e)=>(0,g.sql)`${g.self} NOT BETWEEN (${F(r)}) AND (${F(e)})`;v.notBetween=cf;var ff=(r,e)=>(0,g.sql)`${g.self} NOT BETWEEN SYMMETRIC (${F(r)}) AND (${F(e)})`;v.notBetweenSymmetric=ff;var df=r=>(0,g.sql)`${g.self} LIKE ${F(r)}`;v.like=df;var hf=r=>(0,g.sql)`${g.self} NOT LIKE ${F(r)}`;v.notLike=hf;var pf=r=>(0,g.sql)`${g.self} ILIKE ${F(r)}`;v.ilike=pf;var mf=r=>(0,g.sql)`${g.self} NOT ILIKE ${F(r)}`;v.notIlike=mf;var yf=r=>(0,g.sql)`${g.self} SIMILAR TO ${F(r)}`;v.similarTo=yf;var vf=r=>(0,g.sql)`${g.self} NOT SIMILAR TO ${F(r)}`;v.notSimilarTo=vf;var gf=r=>(0,g.sql)`${g.self} ~ ${F(r)}`;v.reMatch=gf;var _f=r=>(0,g.sql)`${g.self} ~* ${F(r)}`;v.reImatch=_f;var Ef=r=>(0,g.sql)`${g.self} !~ ${F(r)}`;v.notReMatch=Ef;var wf=r=>(0,g.sql)`${g.self} !~* ${F(r)}`;v.notReImatch=wf;var Sf=r=>r.length>0?(0,g.sql)`${g.self} IN (${(0,g.vals)(r)})`:(0,g.sql)`false`;v.isIn=Sf;var bf=r=>r.length>0?(0,g.sql)`${g.self} NOT IN (${(0,g.vals)(r)})`:(0,g.sql)`true`;v.isNotIn=bf;var xf=(...r)=>(0,g.sql)`(${(0,na.mapWithSeparator)(r,(0,g.sql)` OR `,e=>e)})`;v.or=xf;var Af=(...r)=>(0,g.sql)`(${(0,na.mapWithSeparator)(r,(0,g.sql)` AND `,e=>e)})`;v.and=Af;var Rf=r=>(0,g.sql)`(NOT ${r})`;v.not=Rf;var If=(r,e="millisecond")=>(0,g.sql)`now() + ${(0,g.param)(String(r)+" "+e)}`;v.fromNow=If;v.after=v.gt;v.before=v.lt;v.now=(0,g.sql)`now()`;var Tf=r=>(0,g.sql)`${g.self} + ${F(r)}`;v.add=Tf;var Cf=r=>(0,g.sql)`${g.self} - ${F(r)}`;v.subtract=Cf});var sa=I(ie=>{"use strict";d();var Pf=ie&&ie.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),$e=ie&&ie.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Pf(e,r,t)};Object.defineProperty(ie,"__esModule",{value:!0});ie.conditions=void 0;$e(zs(),ie);$e(er(),ie);$e(Pt(),ie);$e(ea(),ie);$e(Sn(),ie);$e(ta(),ie);$e(ra(),ie);ie.conditions=ia()});var aa=I(Ve=>{"use strict";d();var Df=Ve&&Ve.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Of=Ve&&Ve.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Df(e,r,t)};Object.defineProperty(Ve,"__esModule",{value:!0});Of(sa(),Ve)});d();var ca=Lt(Zt());d();var A=Lt(aa(),1);var jd=A.default.ColumnNames,Wd=A.default.ColumnValues,Hd=A.default.Constraint,Gd=A.default.DangerousRawString,zd=A.default.Default,Kd=A.default.IsolationLevel,Yd=A.default.NotExactlyOneError,Jd=A.default.Parameter,Xd=A.default.ParentColumn,Zd=A.default.SQLFragment,eh=A.default.SelectResultMode,oa=A.default.all,th=A.default.avg,rh=A.default.cols,nh=A.default.conditions,ih=A.default.constraint,sh=A.default.count,ah=A.default.deletes,oh=A.default.doNothing,lh=A.default.getConfig,uh=A.default.insert,ch=A.default.isDatabaseError,fh=A.default.max,dh=A.default.min,xn=A.default.param,hh=A.default.parent,ph=A.default.raw,mh=A.default.readCommitted,yh=A.default.readCommittedRO,vh=A.default.repeatableRead,gh=A.default.repeatableReadRO,la=A.default.select,_h=A.default.selectExactlyOne,Eh=A.default.selectOne,wh=A.default.self,Sh=A.default.serializable,bh=A.default.serializableRO,xh=A.default.serializableRODeferrable,Ah=A.default.setConfig,ua=A.default.sql,Rh=A.default.strict,Ih=A.default.sum,Th=A.default.toBuffer,Ch=A.default.toDate,Ph=A.default.toString,Dh=A.default.transaction,Oh=A.default.truncate,Nh=A.default.update,qh=A.default.upsert,Lh=A.default.vals;Ht();d();var An=Lt(Br());Ht();function Rn(r){if(ge.disableSCRAM){let e=r;typeof e=="string"&&(e=(0,An.parse)(e)),e.connectionString&&(e=Object.assign({},e,(0,An.parse)(e.connectionString))),delete e.connectionString;let t=e.host??process.env.PGHOST??process.env.host;if(typeof t=="string"&&/[.]neon[.]tech(:|$)/.test(t)){let n=t.match(/^([^.]+)[.]/);if(n!==null){let i=n[1],s=e.password??process.env.PGPASSWORD??process.env.password;typeof s=="string"&&(e.password=`project=${i};${s}`,e.ssl=!0,r=e)}}}return r}var Uh={async fetch(r,e,t){let n=r.cf??{},i=n.latitude??"37.818496",s=n.longitude??"-122.473831",a=n.city??"Unknown location (assuming San Francisco)",l=n.country??"Earth";ge.wasmPath=e.WASM_PATH;let o=new ca.Client(Rn(e.DATABASE_URL));await o.connect();let f=ua`
      ${"location"} <-> st_makepoint(${xn(s)}, ${xn(i)})`,h=await la("whc_sites_2021",oa,{columns:["name_en","id_no","category"],extras:{distance:f},order:{by:f,direction:"ASC"},limit:10}).run(o);return t.waitUntil(o.end()),new Response(JSON.stringify({lat:i,lng:s,city:a,country:l,nearestSites:h},null,2),{headers:{"Content-Type":"application/json"}})}};export{Uh as default};
